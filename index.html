<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8308NNRLFJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-8308NNRLFJ');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pietro Uni | Interactive Portfolio</title>
    <meta name="description" content="An OS-inspired interactive portfolio showcasing my journey and projects" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pietrouni.com/">
    <meta property="og:title" content="Pietro Uni | Interactive Portfolio">
    <meta property="og:description" content="OS-inspired interactive portfolio showcasing DevOps and Infrastructure projects">
    <meta property="og:image" content="https://pietrouni.com/og-image.jpg">

    <!-- fka twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://pietrouni.com/">
    <meta name="twitter:title" content="Pietro Uni | Interactive Portfolio">
    <meta name="twitter:description" content="OS-inspired interactive portfolio showcasing DevOps and Infrastructure projects">
    <meta name="twitter:image" content="https://pietrouni.com/og-image.jpg">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Preconnect to speed up external resource loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://images.unsplash.com">

    <!-- Preload Critical Font -->
    <link rel="preload" href="/fonts/fixedsys.ttf" as="font" type="font/ttf" crossorigin fetchpriority="high">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        // Resume Fonts
                        sans: ['"Test Tiempos Text"', 'Georgia', 'serif'],
                        serif: ['"Copernicus Trial"', 'serif'],
                        headline: ['"Test Tiempos Headline"', 'serif'],

                        // System Fonts
                        ui: ['"Noto Sans"', 'sans-serif'],
                        kernel: ['"Fixedsys"', 'monospace'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        // 'Her' Palette - Updated to Blue Theme
                        her: {
                            red: "#4A7C9D",      // The distinct blue interface color
                            orange: "#4A7C9D",   // Mapped to Blue for consistency in Dark Mode accents
                            cream: "#F4EBD9",    // Paper background
                            paper: "#FDFBF7",    // Brighter paper
                            dark: "#3E2723",     // Deep warm brown (instead of black)
                            darker: "#1a100c",   // Darkest brown
                            text: "#4E342E",     // Standard text
                            textLight: "#EFEBE9" // Light text
                        }
                    },
                    animation: {
                        'gradient-x': 'gradient-x 30s ease infinite',
                        'dock-bounce': 'dockBounce 0.5s ease',
                    },
                    keyframes: {
                        'gradient-x': {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            },
                        },
                        dockBounce: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        }
                    }
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        /* Custom Fonts from S3 bucket */
        @font-face {
            font-family: 'Copernicus Trial';
            src: url('/fonts/CopernicusTrial-Heavy.ttf') format('truetype');
            font-weight: 900;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Copernicus Trial';
            src: url('/fonts/CopernicusTrial-Extrabold.ttf') format('truetype');
            font-weight: 800;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Test Tiempos Headline';
            src: url('/fonts/TestTiemposHeadline-Regular.otf') format('opentype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Test Tiempos Headline';
            src: url('/fonts/TestTiemposHeadline-Semibold.otf') format('opentype');
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Test Tiempos Text';
            src: url('/fonts/TestTiemposText-Regular.otf') format('opentype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Fixedsys';
            src: url('/fonts/fixedsys.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        body {
            font-family: 'Noto Sans', sans-serif;
            overflow: hidden;
            user-select: none;
            cursor: default;
            letter-spacing: 0.3px;
            /* Prevent pull-to-refresh on mobile */
            overscroll-behavior: none;
        }

        /* Warm Ambient Background - Base Classes */
        .her-bg {
            background: linear-gradient(135deg, #F4EBD9 0%, #E6CEB3 100%);
        }

        .her-bg-dark {
            background: linear-gradient(135deg, #2D1A14 0%, #1A0F0C 100%);
        }

        /* Cards / Windows (Tactile, not Glass) */
        .window {
            transition: opacity 0.3s ease, transform 0.3s ease;
            /* Solid paper feel */
            background-color: #FDFBF7;
            box-shadow: 0 10px 30px rgba(62, 39, 35, 0.15);
            border: 1px solid transparent;
            display: flex;
            flex-direction: column;
            border-radius: 12px;
            container-type: inline-size;
            overflow: hidden;
            /* Clip content for border radius */
            pointer-events: auto;
            touch-action: none;
            /* Prevent browser scrolling handling */
        }

        .window.maximized {
            transition: width 0.3s ease, height 0.3s ease, top 0.3s ease, left 0.3s ease;
            border-radius: 0;
            box-shadow: none;
        }

        .window.minimized {
            transform: scale(0);
            opacity: 0;
            pointer-events: none;
        }

        html.dark .window {
            background-color: #3E2723;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4);
            color: #EFEBE9;
        }

        /* Window Header (macOS Style) */
        .window-header {
            height: 38px;
            min-height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Center title */
            padding: 0 16px;
            background: rgba(0, 0, 0, 0.03);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            position: relative;
            cursor: default;
        }

        html.dark .window-header {
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .traffic-lights {
            display: flex;
            gap: 8px;
            position: absolute;
            left: 16px;
            z-index: 10;
        }

        .win-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 1px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.1s;
        }

        .win-btn:hover {
            opacity: 0.8;
        }

        .win-btn:active {
            transform: scale(0.9);
        }

        .btn-close {
            background-color: #FF5F56;
            border-color: #E0443E;
        }

        .btn-min {
            background-color: #FFBD2E;
            border-color: #DEA123;
        }

        .btn-max {
            background-color: #27C93F;
            border-color: #1AAB29;
        }

        .window-title {
            font-family: 'Noto Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            opacity: 0.7;
            pointer-events: none;
        }

        /* Fluid Typography & Spacing based on Container Width (cqw) */
        .dyn-p {
            padding: clamp(1.5rem, 5cqw, 4rem);
        }

        .dyn-text {
            font-size: clamp(0.9rem, 2.5cqw, 1.1rem);
            line-height: 1.6;
        }

        .dyn-h1 {
            font-size: clamp(2rem, 8cqw, 3.5rem);
            margin-bottom: clamp(1.5rem, 4cqw, 3rem);
            line-height: 1.1;
        }

        .dyn-h2 {
            font-size: clamp(1.25rem, 4cqw, 1.8rem);
            margin-bottom: clamp(0.75rem, 2cqw, 1.5rem);
            margin-top: clamp(1.5rem, 4cqw, 3rem);
        }

        /* Grid that reacts to container width */
        .dyn-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: clamp(1.5rem, 4cqw, 3rem);
        }

        @container (min-width: 500px) {
            .dyn-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Active State - The Blue Frame */
        .window.active-window {
            border: 1px solid #4A7C9D;
            /* Her Blue */
        }

        html.dark .window.active-window {
            border: 1px solid #4A7C9D;
            /* Blue in Dark mode too */
        }

        .window.dragging {
            transition: none;
            opacity: 0.95;
            box-shadow: 0 30px 60px rgba(62, 39, 35, 0.2);
        }

        .window.resizing {
            transition: none;
        }

        .window.dragging iframe,
        .window.resizing iframe {
            pointer-events: none;
        }

        .window-content {
            scrollbar-width: thin;
            scrollbar-color: #4A7C9D transparent;
        }

        html.dark .window-content {
            scrollbar-color: #4A7C9D transparent;
        }

        /* Dock - Refined Design */
        .dock-container {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(253, 251, 247, 0.45);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
            border-radius: 24px;
            position: relative;
            transform-origin: bottom center;
            transition: width 0.3s ease;
        }

        html.dark .dock-container {
            background: rgba(45, 26, 20, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        /* Dock Item - Mobile First */
        .dock-item {
            width: 52px;
            height: 52px;
            position: relative;
            transition: transform 0.2s cubic-bezier(0.25, 1, 0.5, 1), margin 0.2s;
            color: #4A7C9D; /* Default icon color */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (min-width: 768px) {
            .dock-item {
                width: 52px;
                height: 52px;
            }
        }

        html.dark .dock-item {
            color: #4A7C9D;
        }

        .dock-item:hover {
            transform: scale(1.15) translateY(-8px);
        }

        /* Active Indicator Dot */
        .dock-item.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: #4A7C9D;
            box-shadow: 0 0 4px #4A7C9D;
            transition: opacity 0.3s ease;
        }

        /* Launch Animation */
        .animate-dock-bounce {
            animation: dockBounce 0.6s cubic-bezier(0.28, 0.84, 0.42, 1);
        }

        /* Icon Shapes (SVG) - Mobile First */
        .dock-icon {
            width: 32px;
            height: 32px;
            fill: currentColor;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.05));
        }

        @media (min-width: 768px) {
            .dock-icon {
                width: 30px;
                height: 30px;
            }
        }

        /* Tooltip Labels */
        .dock-label {
            position: absolute;
            bottom: 65px;
            left: 50%;
            transform: translateX(-50%) translateY(8px);
            background: #3E2723;
            color: #F4EBD9;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-family: 'Copernicus Trial', serif;
            font-weight: 800;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        @media (min-width: 768px) {
            .dock-label {
                display: block;
            }
        }

        html.dark .dock-label {
            background: #F4EBD9;
            color: #3E2723;
        }

        .dock-item:hover .dock-label {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Menu Bar */
        #menubar {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            background: rgba(244, 235, 217, 0.4);
            border-bottom: 1px solid rgba(74, 124, 157, 0.1);
        }

        html.dark #menubar {
            background: rgba(62, 39, 35, 0.4);
            border-bottom: 1px solid rgba(74, 124, 157, 0.1);
        }

        /* Spotlight Search */
        #spotlight {
            backdrop-filter: blur(8px);
            background: rgba(0, 0, 0, 0.4);
        }

        .spotlight-result {
            transition: all 0.1s;
            cursor: pointer;
        }

        .spotlight-result.selected,
        .spotlight-result:hover {
            background: rgba(74, 124, 157, 0.1);
            border-left: 3px solid #4A7C9D;
        }

        /* Custom Scrollbar - Blue */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #4A7C9D;
            border-radius: 2px;
        }

        html.dark ::-webkit-scrollbar-thumb {
            background: #4A7C9D;
        }

        canvas {
            image-rendering: auto;
        }

        /* Minimalist Inputs */
        .her-input {
            background: transparent;
            border-bottom: 2px solid #4A7C9D;
            color: inherit;
            font-family: 'Copernicus Trial', serif;
            font-weight: 800;
        }

        .her-input:focus {
            outline: none;
            border-bottom-color: #4A7C9D;
        }

        /* Typography Override */
        h1,
        h2,
        h3 {
            font-family: 'Copernicus Trial', serif;
        }

        p {
            font-family: 'Test Tiempos Text', serif;
        }

        /* Link styling in content */
        .content-link {
            color: #4A7C9D;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }

        .content-link:hover {
            border-bottom-color: #4A7C9D;
        }

        html.dark .content-link {
            color: #4A7C9D;
        }

        html.dark .content-link:hover {
            border-bottom-color: #4A7C9D;
        }
    </style>
</head>

<body
    class="h-screen w-screen text-her-text dark:text-her-textLight relative overflow-hidden transition-colors duration-1000 font-ui">

    <!-- Desktop Environment -->
    <div id="desktop" class="absolute inset-0 her-bg-dark transition-all duration-1000">

        <!-- Menu Bar (MacOS Style) -->
        <div id="menubar"
            class="absolute top-0 left-0 w-full h-8 z-[5000] flex justify-between items-center px-4 select-none text-xs md:text-sm font-medium text-her-red dark:text-her-red">
            <div class="flex items-center gap-4">
                <span class="font-bold">Welcome Guest!</span>
            </div>
            <div class="flex items-center gap-4 md:gap-6">

                <!-- Search (Cmd+K) -->
                <button onclick="toggleSpotlight()"
                    class="opacity-70 hover:opacity-100 transition-opacity focus:outline-none flex items-center gap-1 group"
                    title="Search (Cmd+K)">
                    <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>
                    <span
                        class="text-[10px] font-mono opacity-50 group-hover:opacity-100 hidden md:inline pt-0.5">Cmd+K</span>
                </button>

                <!-- Page Info -->
                <button onclick="openWindow('sysinfo')"
                    class="opacity-70 hover:opacity-100 transition-opacity focus:outline-none" title="About This Page">
                    <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                    </svg>
                </button>

                <!-- Wallpaper Switcher -->
                <button onclick="cycleWallpaper()"
                    class="opacity-70 hover:opacity-100 transition-opacity focus:outline-none" title="Switch Wallpaper">
                    <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z" />
                    </svg>
                </button>

                <!-- Theme Toggle -->
                <button onclick="toggleTheme()"
                    class="opacity-70 hover:opacity-100 transition-opacity focus:outline-none" title="Toggle Theme">
                    <!-- Moon Icon (Show when Light, Hide when Dark) -->
                    <svg class="w-4 h-4 fill-current block dark:hidden" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                    <!-- Sun Icon (Hide when Light, Show when Dark) -->
                    <svg class="w-4 h-4 fill-current hidden dark:block" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 17a5 5 0 100-10 5 5 0 000 10zm0-12a2 2 0 110-4 2 2 0 010 4zm0 14a2 2 0 110 4 2 2 0 010-4zm7-7a2 2 0 114 0 2 2 0 01-4 0zM5 12a2 2 0 11-4 0 2 2 0 014 0zm11.95-4.95a2 2 0 112.828-2.828 2 2 0 01-2.828 2.828zM7.05 16.95a2 2 0 11-2.828 2.828 2 2 0 012.828-2.828zm12.728 2.828a2 2 0 11-2.828 2.828 2 2 0 012.828-2.828zM7.05 7.05a2 2 0 11-2.828-2.828 2 2 0 012.828 2.828z" />
                    </svg>
                </button>
                <!-- Clock -->
                <span id="clock" class="font-bold tracking-wide">00:00</span>
            </div>
        </div>

        <!-- Windows Container -->
        <div id="windows-container" class="absolute inset-0 pointer-events-none overflow-hidden mt-8 pb-20 md:pb-24">
            <!-- Windows will be injected here by JS -->
        </div>

        <!-- Spotlight Search Overlay -->
        <div id="spotlight" class="absolute inset-0 z-[6000] hidden flex-col items-center pt-[20vh]"
            onclick="if(event.target.id === 'spotlight') toggleSpotlight()">
            <div class="w-full max-w-lg bg-her-paper dark:bg-[#3E2723] rounded-xl shadow-2xl overflow-hidden border border-her-red/20 transform transition-all duration-300 scale-95 opacity-0"
                id="spotlight-box">
                <div class="p-4 border-b border-her-red/10 flex items-center gap-3">
                    <svg class="w-5 h-5 text-her-red" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>
                    <input type="text" id="spotlight-input" placeholder="Search applications or files..."
                        class="w-full bg-transparent outline-none text-lg font-ui text-her-text dark:text-her-textLight placeholder:opacity-50"
                        autocomplete="off" oninput="handleSearch(this.value)"
                        onkeydown="if(event.key==='Enter') executeSearchResult()">
                </div>
                <div id="spotlight-results" class="max-h-60 overflow-y-auto">
                    <!-- Results injected here -->
                </div>
                <div class="p-2 bg-black/5 dark:bg-white/5 text-[10px] text-center opacity-50 font-mono">
                    PRESS ENTER TO OPEN
                </div>
            </div>
        </div>

        <!-- Bottom Dock -->
        <div
            class="absolute bottom-6 md:bottom-10 left-1/2 transform -translate-x-1/2 z-[9999] mix-blend-normal pointer-events-auto w-full md:w-auto flex justify-center">
            <div class="dock-container rounded-3xl px-6 py-3 flex items-end gap-4 shadow-2xl" role="navigation" aria-label="Application dock">

                <!-- README.md -->
                <div id="dock-about" class="dock-item cursor-pointer group" onclick="restoreWindow('about')" title="README.md" role="button" aria-label="Open README.md">
                    <span class="dock-label">README.md</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <circle cx="12" cy="8" r="4" />
                        <path d="M12 14c-5 0-9 3-9 7h18c0-4-4-7-9-7z" />
                    </svg>
                </div>

                <!-- Projects (Hexagon/Infrastructure) -->
                <div id="dock-projects" class="dock-item cursor-pointer group" onclick="restoreWindow('projects')" title="Projects">
                    <span class="dock-label">Projects</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 2l8.66 5v10L12 22 3.34 17V7L12 2zM12 4.33L4.93 8.16v7.68L12 19.67l7.07-3.83V8.16L12 4.33z" />
                        <path d="M12 8.5l4.5 2.6-4.5 2.6-4.5-2.6L12 8.5z" />
                    </svg>
                </div>

                <!-- Resume (Profile Clipboard) -->
                <div id="dock-resume" class="dock-item cursor-pointer group" onclick="restoreWindow('resume')" title="Resume">
                    <span class="dock-label">Resume</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h5v7h7v9H6z" />
                        <circle cx="12" cy="11" r="2" />
                        <path d="M8 17h8" />
                    </svg>
                </div>

                <!-- Vault (Secure Archive/Briefcase) -->
                <div id="dock-vault" class="dock-item cursor-pointer group" onclick="restoreWindow('vault')" title="Vault">
                    <span class="dock-label">Vault</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20 6h-3V4c0-1.1-.9-2-2-2h-6c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM9 4h6v2H9V4zm11 14H4V8h16v10z" />
                        <path d="M12 14c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z" />
                    </svg>
                </div>

                <!-- Terminal (Command Console) -->
                <div id="dock-terminal" class="dock-item cursor-pointer group" onclick="restoreWindow('terminal')" title="Terminal">
                    <span class="dock-label">Terminal</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 18V6h16v12H4z" />
                        <path d="M8 10l3 3-3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" fill="none" />
                        <path d="M13 16h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none" />
                    </svg>
                </div>

                <!-- Monitor (Bar Chart Panel) -->
                <div id="dock-monitor" class="dock-item cursor-pointer group" onclick="restoreWindow('monitor')" title="Monitoring">
                    <span class="dock-label">Monitoring</span>
                    <svg class="dock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5z" />
                        <path d="M7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z" />
                    </svg>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Configuration ---
            const config = {
                // Config simplified as boot is removed
            };

            // --- State ---
            let zIndexCounter = 100;
            let activeWindows = {}; // Stores { element, config, state }
            let monitorInterval = null;
            let activeWallpaperIndex = 0;

            // --- Wallpapers ---
            const wallpapers = [
                // Default Warm/Dark
                { light: 'linear-gradient(135deg, #F4EBD9 0%, #E6CEB3 100%)', dark: 'linear-gradient(135deg, #2D1A14 0%, #1A0F0C 100%)' },
                // Blue Mist
                { light: 'linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%)', dark: 'linear-gradient(120deg, #0f2027 0%, #203a43 50%, #2c5364 100%)' },
                // Abstract Dusk
                { light: 'linear-gradient(120deg, #e0c3fc 0%, #8ec5fc 100%)', dark: 'linear-gradient(to right, #243949 0%, #517fa4 100%)' }
            ];

            // --- Vault Data ---
            const vaultData = [
                { id: 'resume-html', title: 'Resume.html', desc: 'My professional resume', type: 'doc', category: 'Professional', status: 'ready', action: "restoreWindow('resume')" },
                { id: 'food', title: 'food.md', desc: 'My favorite food spots and recipes', type: 'food', category: 'Lifestyle', status: 'soon' },
                { id: 'music', title: 'music.md', desc: 'Music that moves me', type: 'music', category: 'Creative', status: 'soon' },
                { id: 'books', title: 'books.md', desc: 'Books that shaped my thinking', type: 'book', category: 'Creative', status: 'soon' },
                { id: 'games', title: 'games.md', desc: 'Games I love', type: 'game', category: 'Lifestyle', status: 'soon' },
                { id: 'apps', title: 'apps.md', desc: 'Apps and tools I swear by', type: 'app', category: 'Resources', status: 'soon' },
                { id: 'blogs', title: 'blogs.md', desc: 'Blogs worth reading', type: 'link', category: 'Resources', status: 'soon' },
                { id: 'sites', title: 'sites.md', desc: 'Useful websites', type: 'link', category: 'Resources', status: 'soon' },
                { id: 'videos', title: 'videos.md', desc: 'Videos and channels I follow', type: 'video', category: 'Creative', status: 'soon' },
                { id: 'travel', title: 'travel.md', desc: 'Travel stories and recommendations', type: 'location', category: 'Lifestyle', status: 'soon' }
            ];

            // --- Terminal State ---
            let currentPath = '/home/guest';
            let terminalHistory = [];
            let terminalHistoryIndex = -1;
            let guessGame = { active: false, target: 0, attempts: 0 };
            const fileSystem = {
                'root': {
                    'home': {
                        'guest': {
                            'vault': { /* Conceptual, items are in Vault app */ },
                            'projects': {
                                'pietrouni.com': 'FILE',
                                'terraform-modules': 'FILE',
                                'network-automation': 'FILE'
                            },
                            'photos': {
                                'vacation.jpg': 'FILE',
                                'setup.png': 'FILE'
                            },
                            'experiments': {
                                'prototype-1.html': 'FILE',
                                'test-render.html': 'FILE'
                            },
                            'readme.md': 'FILE',
                            'todo.txt': 'FILE',
                            '.config': 'FILE',
                            '.secrets': 'FILE'
                        }
                    },
                    'bin': {},
                    'etc': {}
                }
            };

            const asciiAlpha = {
                'A': ["  A  ", " A A ", "AAAAA", "A   A", "A   A"],
                'B': ["BBBB ", "B   B", "BBBB ", "B   B", "BBBB "],
                'C': [" CCC ", "C    ", "C    ", "C    ", " CCC "],
                'D': ["DDDD ", "D   D", "D   D", "D   D", "DDDD "],
                'E': ["EEEEE", "E    ", "EEEEE", "E    ", "EEEEE"],
                'F': ["FFFFF", "F    ", "FFFF ", "F    ", "F    "],
                'G': [" GGG ", "G    ", "G  GG", "G   G", " GGG "],
                'H': ["H   H", "H   H", "HHHHH", "H   H", "H   H"],
                'I': [" III ", "  I  ", "  I  ", "  I  ", " III "],
                'J': ["JJJJJ", "  J  ", "  J  ", "J J  ", " J   "],
                'K': ["K   K", "K  K ", "KKK  ", "K  K ", "K   K"],
                'L': ["L    ", "L    ", "L    ", "L    ", "LLLLL"],
                'M': ["M   M", "MM MM", "M M M", "M   M", "M   M"],
                'N': ["N   N", "NN  N", "N N N", "N  NN", "N   N"],
                'O': [" OOO ", "O   O", "O   O", "O   O", " OOO "],
                'P': ["PPPP ", "P   P", "PPPP ", "P    ", "P    "],
                'Q': [" QQQ ", "Q   Q", "Q   Q", "Q  Q ", " QQ Q"],
                'R': ["RRRR ", "R   R", "RRRR ", "R  R ", "R   R"],
                'S': [" SSS ", "S    ", " SSS ", "    S", "SSSS "],
                'T': ["TTTTT", "  T  ", "  T  ", "  T  ", "  T  "],
                'U': ["U   U", "U   U", "U   U", "U   U", " UUU "],
                'V': ["V   V", "V   V", "V   V", " V V ", "  V  "],
                'W': ["W   W", "W   W", "W W W", "WW WW", "W   W"],
                'X': ["X   X", " X X ", "  X  ", " X X ", "X   X"],
                'Y': ["Y   Y", " Y Y ", "  Y  ", "  Y  ", "  Y  "],
                'Z': ["ZZZZZ", "   Z ", "  Z  ", " Z   ", "ZZZZZ"],
                '0': [" 000 ", "0  00", "0 0 0", "00  0", " 000 "],
                '1': ["  1  ", " 11  ", "  1  ", "  1  ", "11111"],
                '2': [" 222 ", "2   2", "   2 ", "  2  ", "22222"],
                '3': ["33333", "    3", "  33 ", "    3", "33333"],
                '4': ["   4 ", "  44 ", " 4 4 ", "44444", "   4 "],
                '5': ["55555", "5    ", "5555 ", "    5", "5555 "],
                '6': [" 666 ", "6    ", "6666 ", "6   6", " 666 "],
                '7': ["77777", "    7", "   7 ", "  7  ", " 7   "],
                '8': [" 888 ", "8   8", " 888 ", "8   8", " 888 "],
                '9': [" 999 ", "9   9", " 9999", "    9", " 999 "],
                ' ': ["     ", "     ", "     ", "     ", "     "]
            };

            const fortunes = [
                "If you donâ€™t work hard on your own dreams, youâ€™ll eventually end up building someone elseâ€™s.",
                "The only way to do great work is to love what you do.",
                "Sometimes the correct path, the bravest path is the least obvious, and also the gentlest.",
                "If you don't like what is being said, change the conversation.",
                "Even though success is a reality, it's effects are temporary.",
                "Take a gamble that love exists, and do a loving act."
            ];

            // --- Theme & Wallpaper Logic ---
            function initTheme() {
                const desktop = document.getElementById('desktop');
                if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    document.documentElement.classList.add('dark');
                    // Initial load: remove defaults to allow style override
                    desktop.classList.remove('her-bg', 'her-bg-dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    desktop.classList.remove('her-bg', 'her-bg-dark');
                }
                applyWallpaper();
            }

            function applyWallpaper() {
                const isDark = document.documentElement.classList.contains('dark');
                const wp = wallpapers[activeWallpaperIndex];
                const desktop = document.getElementById('desktop');
                desktop.style.background = isDark ? wp.dark : wp.light;
            }

            window.toggleTheme = function () {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.theme = 'light';
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.theme = 'dark';
                }
                applyWallpaper();

                const frames = document.querySelectorAll('iframe');
                const newTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                frames.forEach(frame => {
                    frame.contentWindow.postMessage({ type: 'theme-change', theme: newTheme }, '*');
                });
            }

            window.cycleWallpaper = function () {
                activeWallpaperIndex = (activeWallpaperIndex + 1) % wallpapers.length;
                applyWallpaper();
            }

            window.addEventListener('message', (event) => {
                if (event.data && event.data.type === 'request-theme') {
                    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                    event.source.postMessage({ type: 'theme-change', theme: currentTheme }, '*');
                }
            });

            // Listen for real-time system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                // Only auto-switch if user hasn't manually set a preference
                if (!('theme' in localStorage)) {
                    if (e.matches) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                    applyWallpaper();
                    // Notify iframes of theme change
                    const frames = document.querySelectorAll('iframe');
                    const newTheme = e.matches ? 'dark' : 'light';
                    frames.forEach(frame => {
                        frame.contentWindow.postMessage({ type: 'theme-change', theme: newTheme }, '*');
                    });
                }
            });

            initTheme();

            // --- Spotlight Search Logic ---
            window.toggleSpotlight = function () {
                const spot = document.getElementById('spotlight');
                const box = document.getElementById('spotlight-box');
                const input = document.getElementById('spotlight-input');

                if (spot.classList.contains('hidden')) {
                    spot.classList.remove('hidden');
                    spot.classList.add('flex');
                    setTimeout(() => {
                        box.classList.remove('scale-95', 'opacity-0');
                        box.classList.add('scale-100', 'opacity-100');
                        input.focus();
                    }, 10);
                    window.handleSearch('');
                } else {
                    box.classList.remove('scale-100', 'opacity-100');
                    box.classList.add('scale-95', 'opacity-0');
                    setTimeout(() => {
                        spot.classList.add('hidden');
                        spot.classList.remove('flex');
                    }, 300);
                }
            }

            document.addEventListener('keydown', (e) => {
                if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                    e.preventDefault();
                    window.toggleSpotlight();
                }
                if (e.key === 'Escape' && !document.getElementById('spotlight').classList.contains('hidden')) {
                    window.toggleSpotlight();
                }
            });

            window.handleSearch = function (query) {
                const container = document.getElementById('spotlight-results');
                container.innerHTML = '';
                const term = query.toLowerCase();

                const results = [];

                // Search Windows (Apps)
                Object.keys(windows).forEach(key => {
                    const w = windows[key];
                    if (w.title.toLowerCase().includes(term) || key.includes(term)) {
                        results.push({
                            title: w.title,
                            desc: 'Application',
                            action: `restoreWindow('${key}'); toggleSpotlight();`,
                            icon: `<div class="w-8 h-8 rounded bg-her-red text-white flex items-center justify-center font-bold text-xs">${w.title.substring(0, 2).toUpperCase()}</div>`
                        });
                    }
                });

                // Search Vault
                vaultData.forEach(item => {
                    if (item.title.toLowerCase().includes(term) || item.desc.toLowerCase().includes(term)) {
                        results.push({
                            title: item.title,
                            desc: `Vault â€¢ ${item.category}`,
                            action: item.action ? `${item.action}; toggleSpotlight();` : null,
                            icon: `<div class="w-8 h-8 rounded bg-gray-200 dark:bg-gray-700 text-gray-500 flex items-center justify-center"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div>`
                        });
                    }
                });

                if (results.length === 0) {
                    container.innerHTML = `<div class="p-4 text-center opacity-50 text-sm">No results found.</div>`;
                    return;
                }

                results.forEach((res, idx) => {
                    const div = document.createElement('div');
                    div.className = `spotlight-result p-3 flex items-center gap-3 border-b border-her-red/5 last:border-0 ${idx === 0 ? 'selected' : ''}`;
                    if (res.action) div.setAttribute('onclick', res.action);

                    div.innerHTML = `
                    ${res.icon}
                    <div>
                        <div class="font-bold text-sm text-her-text dark:text-her-textLight">${res.title}</div>
                        <div class="text-xs opacity-60">${res.desc}</div>
                    </div>
                 `;
                    container.appendChild(div);
                });
            }

            window.executeSearchResult = function () {
                const first = document.querySelector('.spotlight-result');
                if (first) first.click();
            }

            // --- Window Management ---
            const windows = {
                sysinfo: {
                    title: "About OS93",
                    content: `
                     <div class="h-full flex flex-col bg-her-paper dark:bg-[#1a100c] text-her-text dark:text-her-textLight p-6 select-none font-ui">
                        <h1 class="text-xl font-bold mb-1 font-serif">About OS93</h1>
                        <div class="text-xs opacity-60 mb-4 font-mono">Version 1.4 (Blue-Jonze)</div>
                        <div class="h-px bg-her-text/10 dark:bg-white/10 w-full mb-4"></div>

                        <div class="flex-1 overflow-y-auto pr-2 space-y-4 text-sm">
                            <div>
                                <div class="font-bold opacity-40 mb-2 text-xs uppercase tracking-wider">Built with</div>
                                <ul class="space-y-1 opacity-80">
                                    <li>â€¢ HTML5 & Vanilla JavaScript</li>
                                    <li>â€¢ Tailwind CSS (CDN)</li>
                                    <li>â€¢ HTML5 Canvas (Animations)</li>
                                    <li>â€¢ Lucide Icons (SVGs)</li>
                                </ul>
                            </div>

                            <div>
                                <div class="font-bold opacity-40 mb-2 text-xs uppercase tracking-wider">Typography</div>
                                <ul class="space-y-3 opacity-80">
                                    <li class="flex flex-col">
                                        <span class="text-[10px] uppercase opacity-50">Serif (Display)</span>
                                        <span class="font-serif font-extrabold text-lg">Copernicus Trial</span>
                                    </li>
                                    <li class="flex flex-col">
                                        <span class="text-[10px] uppercase opacity-50">Serif (Body)</span>
                                        <span class="font-sans text-lg">Test Tiempos Text</span>
                                    </li>
                                    <li class="flex flex-col">
                                        <span class="text-[10px] uppercase opacity-50">System UI</span>
                                        <span class="font-ui text-lg">Noto Sans</span>
                                    </li>
                                    <li class="flex flex-col">
                                        <span class="text-[10px] uppercase opacity-50">Terminal</span>
                                        <span class="font-kernel text-lg">Fixedsys</span>
                                    </li>
                                </ul>
                            </div>

                        </div>

                        <div class="mt-6 text-center text-xs opacity-60 font-mono">
                            Created by Pietro Uni<br>
                            Â© 2025 All rights reserved
                        </div>

                        <div class="mt-4 flex justify-center">
                            <button onclick="closeWindow('sysinfo')" class="px-6 py-2 bg-black/5 dark:bg-white/5 hover:bg-black/10 dark:hover:bg-white/10 border border-her-text/10 dark:border-white/10 rounded-md text-sm font-medium transition-colors">Close</button>
                        </div>
                     </div>
                `,
                    width: 400,
                    height: 600
                },
                about: {
                    title: "README.md",
                    content: `
                    <div class="h-full dyn-p font-sans dyn-text overflow-y-auto window-content selection:bg-her-red selection:text-white transition-colors">
                        <!-- Header -->
                        <h1 class="dyn-h1 font-serif font-extrabold text-her-red dark:text-her-red tracking-tight">Hi, I'm Pietro ðŸ‘‹</h1>
                        
                        <div class="space-y-4">
                            <!-- My Journey -->
                            <div>
                                <h2 class="dyn-h2 font-serif font-extrabold text-her-dark dark:text-her-cream">My Journey</h2>
                                <p class="opacity-90">
                                    I'm an Infrastructure Engineer based in Barcelona with a somewhat winding path through tech. What started as HP printer support in 2014 eventually led me through enterprise help desk work, specialized medical device support, and into the world of enterprise networking. I spent over three years at <span class="font-semibold text-her-red dark:text-her-red">Cisco TAC</span> solving complex routing, switching, and SDN problems for Fortune 500 companiesâ€”the kind of work that teaches you how distributed systems actually break in production.
                                </p>
                                <p class="opacity-90 mt-4">
                                    These days, I have been working on Infrastructure for the last two years and I'm actively transitioning toward DevOps and Platform Engineering. I've realized I'd rather build and automate systems than just keep them running.
                                </p>
                            </div>

                            <!-- What I'm Building -->
                            <div>
                                <h2 class="dyn-h2 font-serif font-extrabold text-her-dark dark:text-her-cream">What I'm Building</h2>
                                <p class="opacity-90 mb-4">
                                    I believe the best way to learn is to build things that actually work. My current focus is creating production-grade infrastructure projects that demonstrate real DevOps capabilities:
                                </p>
                                <ul class="list-none space-y-4">
                                    <li class="pl-4 border-l-2 border-her-red">
                                        <a href="https://pietrouni.com" target="_blank" class="content-link font-bold">pietrouni.com</a> â€“ My portfolio site running on AWS with full Infrastructure-as-Code. Multi-AZ VPC, auto-scaling groups, CloudFront CDN, all managed through Terraform with proper state management.
                                    </li>
                                    <li class="pl-4 border-l-2 border-her-red">
                                        <span class="font-bold">Reusable Terraform modules</span> â€“ Building blocks for VPC networking, compute resources, and container orchestration that work across dev/staging/prod environments.
                                    </li>
                                    <li class="pl-4 border-l-2 border-her-red">
                                        <span class="font-bold">Network automation</span> â€“ Python scripts that eliminate manual configuration work across Cisco infrastructure.
                                    </li>
                                </ul>
                                <p class="mt-4 italic opacity-70">You can see the code behind these projects on my <a href="https://github.com/pietrocious" target="_blank" class="content-link">GitHub</a>.</p>
                            </div>

                            <!-- Why DevOps -->
                            <div>
                                <h2 class="dyn-h2 font-serif font-extrabold text-her-dark dark:text-her-cream">Why DevOps?</h2>
                                <p class="opacity-90">
                                    After years of troubleshooting other people's infrastructure, I want to be the one designing and building it. My networking background gives me an edgeâ€”I understand how distributed systems communicate, fail, and scale. DevOps lets me leverage that foundation while learning to automate, containerize, and orchestrate at scale.
                                </p>
                            </div>

                            <!-- Beyond Work -->
                            <div>
                                <h2 class="dyn-h2 font-serif font-extrabold text-her-dark dark:text-her-cream">Beyond Work</h2>
                                <p class="opacity-90">
                                    Outside of infrastructure work, I listen to music across pretty much every genre, play games when I have time, and enjoy understanding how complex systems get built. I'm fascinated by the engineering behind games and tech products; the coordination, the tradeoffs, the architecture decisions that make something actually work at such a scale, and how much we're all standing on the shoulders of giants.
                                </p>
                            </div>

                            <!-- Let's Connect -->
                            <div>
                                <h2 class="dyn-h2 font-serif font-extrabold text-her-dark dark:text-her-cream">Let's Connect</h2>
                                <p class="opacity-90">
                                    If you'd like to talk, please reach out:
                                </p>
                                <div class="mt-4 flex gap-4 text-sm font-bold tracking-wide">
                                    <a href="mailto:pietrouni@gmail.com" class="content-link">EMAIL</a>
                                    <span class="opacity-30">/</span>
                                    <a href="https://github.com/pietrocious" target="_blank" class="content-link">GITHUB</a>
                                    <span class="opacity-30">/</span>
                                    <a href="https://linkedin.com/in/pietrouni" target="_blank" class="content-link">LINKEDIN</a>
                                </div>
                            </div>
                            
                            <div class="h-12"></div>
                        </div>
                    </div>
                `,
                    width: 700,
                    height: 800
                },
                projects: {
                    title: "Projects",
                    content: `
                     <div class="h-full dyn-p font-sans overflow-y-auto window-content selection:bg-her-red selection:text-white">
                        <h1 class="dyn-h1 font-serif font-extrabold text-her-red dark:text-her-red tracking-tight mb-8">Projects</h1>
                        <p class="mb-8 opacity-80 dyn-text">A collection of my infrastructure and automation work.</p>
                        
                        <div class="dyn-grid">
                            <!-- pietrouni.com -->
                            <div class="p-6 border border-her-red/20 rounded-lg transition-colors bg-white/40 dark:bg-black/10 opacity-70">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-serif font-extrabold text-lg text-her-red dark:text-her-red">pietrouni.com</h3>
                                    <span class="px-2 py-0.5 text-[10px] font-bold bg-yellow-100 text-yellow-800 rounded">Repo Coming Soon</span>
                                </div>
                                <p class="text-sm opacity-80 mb-4">Full desktop portfolio website, with infrastructure on AWS.</p>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">HTML</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">CSS</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">JAVASCRIPT</span>
                                </div>
                            </div>

                            <!-- AWS Terraform Modules -->
                            <div class="p-6 border border-her-red/20 rounded-lg hover:border-her-red/50 transition-colors bg-white/40 dark:bg-black/10 cursor-pointer" onclick="window.open('https://github.com/pietrocious/terraform-aws-pietrouni', '_blank')">
                                <h3 class="font-serif font-extrabold text-lg mb-2 text-her-red dark:text-her-red">Terraform AWS Modules</h3>
                                <p class="text-sm opacity-80 mb-4">Opinionated, production-ready modules for VPC, EKS, and RDS.</p>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">TERRAFORM</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">AWS</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">CICD</span>
                                </div>
                                <div class="text-xs font-bold uppercase tracking-wide opacity-60">View Repo -></div>
                            </div>
                            
                            <!-- Automation Scripts -->
                            <div class="p-6 border border-her-red/20 rounded-lg transition-colors bg-white/40 dark:bg-black/10 opacity-70">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-serif font-extrabold text-lg text-her-red dark:text-her-red">Automation Scripts</h3>
                                    <span class="px-2 py-0.5 text-[10px] font-bold bg-yellow-100 text-yellow-800 rounded">Repo Coming Soon</span>
                                </div>
                                <p class="text-sm opacity-80 mb-4">PowerShell/bash/Python scripts for Cisco IOS config management and compliance checks.</p>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">POWERSHELL</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">BASH</span>
                                    <span class="px-2 py-1 text-[10px] font-mono border border-her-text/20 rounded">PYTHON</span>
                                </div>
                            </div>
                        </div>
                     </div>
                `,
                    width: 900,
                    height: 700
                },
                resume: {
                    title: "Resume",
                    content: `<iframe src="resume.html" loading="lazy" class="w-full h-full border-none bg-white dark:bg-[#1a100c]" onload="this.contentWindow.postMessage({type:'theme-change', theme: document.documentElement.classList.contains('dark') ? 'dark' : 'light'}, '*')"></iframe>`,
                    width: 850,
                    height: 900
                },
                vault: {
                    title: "Personal Vault",
                    content: `
                    <div id="vault-app" class="h-full flex flex-col bg-her-paper dark:bg-[#2D1A14]">
                        <!-- Search & Header -->
                        <div class="px-6 py-4 flex items-center justify-between border-b border-her-text/10">
                            <h2 class="text-lg font-serif font-extrabold text-her-red dark:text-her-red flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                                <span class="hidden md:inline">Personal Vault</span>
                                <span class="md:hidden">Vault</span>
                            </h2>
                            <div class="relative">
                                <input type="text" placeholder="Search..." oninput="window.renderVault(this.value)" class="pl-9 pr-4 py-1.5 rounded-full bg-black/5 dark:bg-white/5 border border-transparent focus:border-her-red outline-none text-sm transition-all w-32 md:w-64">
                                <svg class="w-4 h-4 absolute left-3 top-2.5 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                            </div>
                        </div>
                        
                        <!-- Filter Tabs -->
                        <div class="px-6 py-3 flex gap-2 overflow-x-auto border-b border-her-text/5 no-scrollbar">
                            <button onclick="window.filterVault('all')" class="vault-tab active px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wide transition-colors bg-her-red text-white flex-shrink-0">All</button>
                            <button onclick="window.filterVault('Professional')" class="vault-tab px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wide transition-colors hover:bg-black/5 dark:hover:bg-white/5 opacity-70 flex-shrink-0">Professional</button>
                            <button onclick="window.filterVault('Lifestyle')" class="vault-tab px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wide transition-colors hover:bg-black/5 dark:hover:bg-white/5 opacity-70 flex-shrink-0">Lifestyle</button>
                            <button onclick="window.filterVault('Creative')" class="vault-tab px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wide transition-colors hover:bg-black/5 dark:hover:bg-white/5 opacity-70 flex-shrink-0">Creative</button>
                            <button onclick="window.filterVault('Resources')" class="vault-tab px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wide transition-colors hover:bg-black/5 dark:hover:bg-white/5 opacity-70 flex-shrink-0">Resources</button>
                        </div>
                        
                        <!-- Grid Content -->
                        <div id="vault-grid" class="flex-1 overflow-y-auto p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                            <!-- Items Injected Here -->
                        </div>
                    </div>
                `,
                    width: 1000,
                    height: 700
                },
                experiments: {
                    title: "Lab // Experiments",
                    content: `
                    <div class="h-full bg-[#0a0a0a] text-green-500 font-mono p-6 overflow-y-auto select-none border-t-4 border-green-500">
                        <div class="flex items-center justify-between mb-8">
                            <div>
                                <h1 class="text-2xl font-bold uppercase tracking-widest">Research & Development</h1>
                                <div class="text-xs opacity-50">SECTOR 7 // RESTRICTED ACCESS</div>
                            </div>
                            <div class="animate-pulse w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="border border-green-500/30 p-4 hover:bg-green-500/10 cursor-pointer transition-all">
                                <div class="text-xs border border-green-500 inline-block px-1 mb-2">PROTOTYPE</div>
                                <h3 class="font-bold text-lg mb-1">WebGL Fluid Sim</h3>
                                <p class="text-xs opacity-60">GPU-accelerated fluid dynamics test using Three.js.</p>
                            </div>
                            <div class="border border-green-500/30 p-4 hover:bg-green-500/10 cursor-pointer transition-all">
                                <div class="text-xs border border-green-500 inline-block px-1 mb-2">CONCEPT</div>
                                <h3 class="font-bold text-lg mb-1">Neural Network Viz</h3>
                                <p class="text-xs opacity-60">Visualizing weights and biases in real-time.</p>
                            </div>
                        </div>
                        
                        <div class="mt-8 text-xs opacity-40">
                            > SYSTEM INTEGRITY: 100%<br>
                            > LOGGING ENABLED
                        </div>
                    </div>
                `,
                    width: 800,
                    height: 600
                },
                terminal: {
                    title: "Terminal",
                    content: `
                    <div class="h-full bg-[#1e1e1e]/95 text-white p-4 font-kernel text-sm overflow-hidden flex flex-col relative" id="term-container" onclick="document.getElementById('cmd-input').focus()">
                        <div id="term-output" class="flex-1 overflow-y-auto space-y-1 mb-2 window-content">
                            <div class="opacity-70">OS93 v1.4 (Blue-Jonze) | Linux micro-kernel 6.8.0-45</div>
                            <div class="mb-4">Type 'help' for available commands.</div>
                        </div>
                        <div class="flex items-center gap-2 text-white z-10">
                            <span id="term-prompt" class="text-white">guest@portfolio ~ $</span>
                            <input id="cmd-input" type="text" class="flex-1 bg-transparent border-none outline-none text-white font-kernel focus:ring-0" autocomplete="off" onkeydown="window.handleTerminalCommand(event)">
                        </div>
                    </div>
                `,
                    width: 850,
                    height: 520
                },
                monitor: {
                    title: "Monitoring",
                    content: `
                    <div class="h-full flex flex-col bg-her-paper dark:bg-[#2D1A14] overflow-hidden">
                        <!-- Tabs -->
                        <div class="flex border-b border-her-text/10 bg-black/5 dark:bg-white/5 overflow-x-auto">
                            <button id="tab-infra" onclick="window.switchMonitorTab('infra')" class="px-4 md:px-6 py-3 text-xs font-bold uppercase tracking-wider border-b-2 border-her-red text-her-red bg-white/50 dark:bg-black/20 flex-shrink-0">Infrastructure</button>
                            <button id="tab-cf" onclick="window.switchMonitorTab('cf')" class="px-4 md:px-6 py-3 text-xs font-bold uppercase tracking-wider border-b-2 border-transparent opacity-60 hover:opacity-100 flex-shrink-0">CloudFront</button>
                            <button id="tab-bill" onclick="window.switchMonitorTab('bill')" class="px-4 md:px-6 py-3 text-xs font-bold uppercase tracking-wider border-b-2 border-transparent opacity-60 hover:opacity-100 flex-shrink-0">Billing</button>
                        </div>

                        <div class="flex-1 relative overflow-y-auto">
                            <!-- Infrastructure View -->
                            <div id="mon-view-infra" class="p-6 space-y-6">
                                <!-- KPI Cards -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="p-4 rounded border border-her-text/10 bg-white/40 dark:bg-white/5">
                                        <div class="text-[10px] uppercase font-ui font-bold opacity-60 mb-1">24h Requests</div>
                                        <div class="text-2xl font-mono text-blue-500 font-bold" id="kpi-req">2.5k</div>
                                        <div class="text-[10px] opacity-50 mt-1 font-ui">CloudFront Hits</div>
                                    </div>
                                    <div class="p-4 rounded border border-her-text/10 bg-white/40 dark:bg-white/5">
                                        <div class="text-[10px] uppercase font-ui font-bold opacity-60 mb-1">Data Transfer</div>
                                        <div class="text-2xl font-mono text-purple-500 font-bold" id="kpi-data">145 MB</div>
                                        <div class="text-[10px] opacity-50 mt-1 font-ui">Outbound Traffic</div>
                                    </div>
                                    <div class="p-4 rounded border border-her-text/10 bg-white/40 dark:bg-white/5">
                                        <div class="text-[10px] uppercase font-ui font-bold opacity-60 mb-1">Edge Latency</div>
                                        <div class="text-2xl font-mono text-green-500 font-bold" id="kpi-lat">24 ms</div>
                                        <div class="text-[10px] opacity-50 mt-1 font-ui">Global Average</div>
                                    </div>
                                </div>

                                <!-- Graph -->
                                <div class="rounded border border-her-text/10 bg-white/40 dark:bg-white/5 p-4 relative overflow-hidden">
                                    <div class="flex justify-between items-center mb-4">
                                        <span class="text-xs font-mono font-bold uppercase tracking-widest">CloudFront Requests / Second</span>
                                        <span class="text-[10px] font-mono text-green-500 animate-pulse">â— Live Traffic</span>
                                    </div>
                                    <canvas id="monitor-canvas" class="w-full h-48"></canvas>
                                    <!-- Scanning Line Effect -->
                                    <div class="absolute inset-0 pointer-events-none bg-gradient-to-b from-transparent via-her-red/5 to-transparent animate-[scan_3s_linear_infinite]" style="background-size: 100% 10px;"></div>
                                </div>

                                <!-- Service Table -->
                                <div class="rounded border border-her-text/10 bg-white/40 dark:bg-white/5 p-4 text-xs font-mono overflow-x-auto">
                                    <div class="min-w-[400px]">
                                        <div class="grid grid-cols-4 gap-4 mb-2 opacity-50 border-b border-her-text/10 pb-2 uppercase font-bold">
                                            <div>Service</div>
                                            <div>Region</div>
                                            <div>Status</div>
                                            <div>Metric</div>
                                        </div>
                                        <div class="space-y-2" id="service-list">
                                            <div class="grid grid-cols-4 gap-4 items-center">
                                                <div>CloudFront</div>
                                                <div class="opacity-60">Global</div>
                                                <div class="text-green-500">Deployed</div>
                                                <div class="opacity-60">Hit Ratio: 99%</div>
                                            </div>
                                            <div class="grid grid-cols-4 gap-4 items-center">
                                                <div>S3 (Origin)</div>
                                                <div class="opacity-60">us-east-1</div>
                                                <div class="text-green-500">Active</div>
                                                <div class="opacity-60">Size: 4.2MB</div>
                                            </div>
                                            <div class="grid grid-cols-4 gap-4 items-center">
                                                <div>Route53</div>
                                                <div class="opacity-60">Global</div>
                                                <div class="text-green-500">Active</div>
                                                <div class="opacity-60">TTL: 60s</div>
                                            </div>
                                            <div class="grid grid-cols-4 gap-4 items-center">
                                                <div>ACM (SSL)</div>
                                                <div class="opacity-60">us-east-1</div>
                                                <div class="text-green-500">Valid</div>
                                                <div class="opacity-60">RSA 2048</div>
                                            </div>
                                            <div class="grid grid-cols-4 gap-4 items-center">
                                                <div>WAF</div>
                                                <div class="opacity-60">Global</div>
                                                <div class="text-amber-500">Blocking</div>
                                                <div class="opacity-60">0 Threats</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Scrolling Log -->
                                <div class="rounded border border-her-text/10 bg-black/80 text-green-400 p-3 text-[10px] font-mono h-24 overflow-hidden relative">
                                    <div class="absolute top-2 right-2 opacity-50">SYSTEM LOG</div>
                                    <div id="sys-log" class="space-y-1 mt-6">
                                        <div>[INFO] Health check passed: us-east-1</div>
                                        <div>[INFO] Cache invalidation completed</div>
                                    </div>
                                </div>
                            </div>

                            <!-- CloudFront View -->
                            <div id="mon-view-cloudfront" class="p-6 hidden">
                                <h3 class="font-serif font-extrabold text-lg mb-6 text-her-red dark:text-her-red">Traffic Distribution</h3>
                                <div class="space-y-6">
                                    <div>
                                        <div class="flex justify-between text-xs mb-1 font-mono uppercase">
                                            <span>North America</span>
                                            <span class="opacity-70">45%</span>
                                        </div>
                                        <div class="h-2 bg-black/5 rounded-full overflow-hidden">
                                            <div class="h-full bg-blue-500 w-[45%]"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between text-xs mb-1 font-mono uppercase">
                                            <span>Europe</span>
                                            <span class="opacity-70">30%</span>
                                        </div>
                                        <div class="h-2 bg-black/5 rounded-full overflow-hidden">
                                            <div class="h-full bg-purple-500 w-[30%]"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between text-xs mb-1 font-mono uppercase">
                                            <span>Asia Pacific</span>
                                            <span class="opacity-70">15%</span>
                                        </div>
                                        <div class="h-2 bg-black/5 rounded-full overflow-hidden">
                                            <div class="h-full bg-orange-500 w-[15%]"></div>
                                        </div>
                                    </div>
                                     <div>
                                        <div class="flex justify-between text-xs mb-1 font-mono uppercase">
                                            <span>South America</span>
                                            <span class="opacity-70">10%</span>
                                        </div>
                                        <div class="h-2 bg-black/5 rounded-full overflow-hidden">
                                            <div class="h-full bg-green-500 w-[10%]"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-8 p-4 bg-yellow-500/10 border border-yellow-500/30 rounded text-xs font-mono">
                                    <strong class="text-yellow-600 block mb-1">âš  CACHE PERFORMANCE</strong>
                                    Edge hit ratio is optimal (99.2%). Low origin fetch rate observed.
                                </div>
                            </div>

                            <!-- Billing View -->
                            <div id="mon-view-billing" class="hidden h-full flex flex-col justify-center items-center p-6 md:p-12 text-center">
                                <div class="w-32 h-32 rounded-full border-4 border-her-red flex items-center justify-center mb-6">
                                    <div>
                                        <div class="text-xs uppercase opacity-60">Est. Cost</div>
                                        <div class="text-2xl font-bold font-mono">$14.20</div>
                                    </div>
                                </div>
                                <div class="w-full max-w-sm space-y-3 text-sm">
                                    <div class="flex justify-between border-b border-her-text/10 pb-1">
                                        <span>Route53 Hosted Zone</span>
                                        <span class="font-mono opacity-70">$0.50</span>
                                    </div>
                                    <div class="flex justify-between border-b border-her-text/10 pb-1">
                                        <span>S3 Standard Storage</span>
                                        <span class="font-mono opacity-70">$0.12</span>
                                    </div>
                                    <div class="flex justify-between border-b border-her-text/10 pb-1">
                                        <span>Data Transfer (Out)</span>
                                        <span class="font-mono opacity-70">$13.58</span>
                                    </div>
                                </div>
                                <p class="mt-8 text-xs opacity-50">Forecast for end of month: $15.00</p>
                                <div class="w-full max-w-sm mt-2 h-1.5 bg-black/5 rounded-full overflow-hidden">
                                    <div class="h-full bg-green-500 w-[45%]"></div>
                                </div>
                                <div class="text-[10px] mt-1 opacity-40 uppercase tracking-widest">Budget: 45% Used</div>
                            </div>
                        </div>
                    </div>
                `,
                    width: 750,
                    height: 550
                }
            };

            // --- Logic: Window Operations ---
            window.openWindow = function (id) {
                if (activeWindows[id]) {
                    restoreWindow(id);
                    return;
                }

                const winConfig = windows[id];

                // Random positioning offset to prevent stacking
                const randX = Math.floor(Math.random() * 50);
                const randY = Math.floor(Math.random() * 50);

                // Container for dynamic window centering
                const container = document.getElementById('windows-container');
                const containerW = container.clientWidth;
                const containerH = container.clientHeight;

                // Mobile Detection
                const isMobile = window.innerWidth < 768;
                
                // Safe Area Calculation (Dock Buffer)
                const dockBuffer = isMobile ? 100 : 120; 
                const maxAvailableHeight = containerH - dockBuffer;

                // Responsive Size Calculation - Full screen on mobile
                let finalW = isMobile ? containerW : winConfig.width;
                
                // Height Constraint: Full height on mobile (minus dock), clamp on desktop
                let finalH = winConfig.height;
                if (isMobile) {
                    finalH = maxAvailableHeight;
                } else if (finalH > maxAvailableHeight) {
                    finalH = maxAvailableHeight;
                }

                // Position: Edge-to-edge on mobile, centered on desktop
                let leftPos = isMobile ? 0 : Math.max(0, (containerW - finalW) / 2) + randX;
                
                // Vertical position: Top on mobile, centered on desktop
                let topPos = isMobile ? 0 : Math.max(10, (maxAvailableHeight - finalH) / 2) + randY;

                // Boundary Check: prevent overlap with dock (desktop only)
                if (!isMobile && topPos + finalH > maxAvailableHeight) {
                    topPos = maxAvailableHeight - finalH;
                    if (topPos < 10) topPos = 10;
                }

                const winEl = document.createElement('div');
                winEl.className = 'window absolute flex flex-col active-window';
                winEl.id = `win-${id}`;
                winEl.style.width = `${finalW}px`;
                winEl.style.height = `${finalH}px`;
                winEl.style.left = `${leftPos}px`;
                winEl.style.top = `${topPos}px`;
                winEl.style.zIndex = ++zIndexCounter;

                // macOS Header + Content
                winEl.innerHTML = `
                <div class="window-header" onmousedown="window.startDrag(event, '${id}')" ondblclick="window.toggleMaximize('${id}')">
                    <div class="traffic-lights" onmousedown="event.stopPropagation()" ontouchstart="event.stopPropagation()">
                        <div class="win-btn btn-close" onclick="window.closeWindow('${id}')"></div>
                        <div class="win-btn btn-min" onclick="window.minimizeWindow('${id}')"></div>
                        <div class="win-btn btn-max" onclick="window.toggleMaximize('${id}')"></div>
                    </div>
                    <span class="window-title">${winConfig.title}</span>
                </div>
                <div class="flex-1 relative overflow-hidden">
                    ${winConfig.content}
                </div>
            `;

                // Mouse down to bring to front
                winEl.addEventListener('mousedown', () => bringToFront(id));
                winEl.addEventListener('touchstart', () => bringToFront(id), { passive: true });

                // 8-direction resize logic
                winEl.onmousemove = (e) => updateWindowCursor(e, winEl);
                winEl.onmousedown = (e) => {
                    bringToFront(id);
                    handleResizeStart(e, winEl, id);
                };

                // Add Touch Listeners for dragging
                addTouchListeners(winEl, id);

                document.getElementById('windows-container').appendChild(winEl);

                activeWindows[id] = { element: winEl, config: winConfig, maximized: false, prevRect: null };
                
                // Dock Animation & State
                const dockItem = document.getElementById(`dock-${id}`);
                if(dockItem) {
                    dockItem.classList.add('active', 'animate-dock-bounce');
                    setTimeout(() => dockItem.classList.remove('animate-dock-bounce'), 600);
                }

                // App specific logic init
                if (id === 'monitor') startMonitor();
                if (id === 'terminal') setTimeout(() => document.getElementById('cmd-input').focus(), 100);
                if (id === 'vault') window.renderVault();
                if (id === 'resume') {
                    // Inject theme via URL param first
                    const theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                    const iframe = winEl.querySelector('iframe');
                    if (iframe) {
                        // Add theme param to src if not present
                        if (iframe.src.indexOf('?') === -1) iframe.src += `?theme=${theme}`;
                    }
                }
            }

            window.closeWindow = function (id) {
                const win = document.getElementById(`win-${id}`);
                if (win) win.remove();
                delete activeWindows[id];
                
                // Dock State
                const dockItem = document.getElementById(`dock-${id}`);
                if(dockItem) dockItem.classList.remove('active');

                if (id === 'monitor' && monitorInterval) clearInterval(monitorInterval);
            }

            window.minimizeWindow = function (id) {
                const winObj = activeWindows[id];
                if (!winObj) return;

                const el = winObj.element;
                const dockItem = document.getElementById(`dock-${id}`);
                
                // Calculate Transform Origin for "Scale" effect towards dock
                let originX = '50%';
                let originY = '100%';

                if (dockItem) {
                    const dockRect = dockItem.getBoundingClientRect();
                    const winRect = el.getBoundingClientRect();
                    
                    // Destination is center of dock icon
                    const destX = dockRect.left + dockRect.width / 2;
                    const destY = dockRect.top + dockRect.height / 2;
                    
                    // Origin relative to window top-left
                    const relX = destX - winRect.left;
                    const relY = destY - winRect.top;
                    
                    originX = `${relX}px`;
                    originY = `${relY}px`;
                } else {
                    // Fallback to center bottom
                    const winRect = el.getBoundingClientRect();
                    const destX = window.innerWidth / 2;
                    const destY = window.innerHeight;
                    originX = `${destX - winRect.left}px`;
                    originY = `${destY - winRect.top}px`;
                }

                // Smooth Transition
                el.style.transition = 'transform 0.5s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s ease';
                el.style.transformOrigin = `${originX} ${originY}`;

                // Trigger Reflow
                el.offsetHeight;

                el.classList.add('minimized');
                el.classList.remove('active-window');
            }

            window.restoreWindow = function (id) {
                if (!activeWindows[id]) {
                    window.openWindow(id);
                    return;
                }
                const winObj = activeWindows[id];
                const el = winObj.element;

                // Restore Transition
                el.style.transition = 'transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s ease';
                
                el.classList.remove('minimized');
                bringToFront(id);
                
                // Cleanup inline styles after animation
                setTimeout(() => {
                    if (!el.classList.contains('minimized')) {
                        el.style.transition = '';
                        el.style.transformOrigin = '';
                    }
                }, 450);
            }

            window.toggleMaximize = function (id) {
                const winObj = activeWindows[id];
                if (!winObj) return;

                const el = winObj.element;

                if (!winObj.maximized) {
                    // Save state
                    winObj.prevRect = {
                        left: el.style.left,
                        top: el.style.top,
                        width: el.style.width,
                        height: el.style.height
                    };

                    // Maximize (Top 0 relative to windows-container which starts below Menu Bar)
                    el.classList.add('maximized');
                    el.style.left = '0px';
                    el.style.top = '0px';
                    el.style.width = '100%';

                    const isMobile = window.innerWidth < 768;
                    // On Mobile maximize full height, on desktop leave room for dock
                    el.style.height = isMobile ? '100%' : 'calc(100% - 90px)';

                    winObj.maximized = true;
                } else {
                    // Restore
                    el.classList.remove('maximized');
                    const prev = winObj.prevRect;
                    el.style.left = prev.left;
                    el.style.top = prev.top;
                    el.style.width = prev.width;
                    el.style.height = prev.height;
                    winObj.maximized = false;
                }
            }

            function bringToFront(id) {
                if (activeWindows[id]) {
                    activeWindows[id].element.style.zIndex = ++zIndexCounter;
                    // Update styling
                    document.querySelectorAll('.window').forEach(w => w.classList.remove('active-window'));
                    activeWindows[id].element.classList.add('active-window');
                }
            }

            // --- Drag Logic ---
            let isDragging = false;
            let dragOffset = { x: 0, y: 0 };
            let dragId = null;

            window.startDrag = function (e, id) {
                if (activeWindows[id].maximized) return; // Prevent drag if maximized

                const win = activeWindows[id].element;
                const rect = win.getBoundingClientRect();

                // Normalize touch/mouse events
                const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

                // Resize Zone Check (Top 10px) - prevent drag if clicking near top edge to allow resize (Desktop only mostly)
                if (!e.type.includes('touch') && clientY - rect.top < 10) return;

                isDragging = true;
                dragId = id;
                dragOffset.x = clientX - rect.left;
                dragOffset.y = clientY - rect.top;
                win.classList.add('dragging');
                bringToFront(id);
                if (e.stopPropagation) e.stopPropagation();
            }

            window.addEventListener('mousemove', (e) => handleMove(e));
            window.addEventListener('mouseup', () => handleEnd());

            function handleMove(e) {
                if (isDragging && dragId) {
                    e.preventDefault();
                    const win = activeWindows[dragId].element;

                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

                    // Constrain to viewport (approx)
                    // Constrain to viewport (approx)
                    const container = win.offsetParent || document.body;
                    const containerRect = container.getBoundingClientRect();
                    let newX = clientX - dragOffset.x - containerRect.left;
                    let newY = clientY - dragOffset.y - containerRect.top;

                    // Keep header accessible
                    if (newY < 0) newY = 0;

                    win.style.left = `${newX}px`;
                    win.style.top = `${newY}px`;
                }
            }

            function handleEnd() {
                if (isDragging && dragId) {
                    activeWindows[dragId].element.classList.remove('dragging');
                }
                isDragging = false;
                dragId = null;
            }

            function addTouchListeners(winEl, id) {
                const header = winEl.querySelector('.window-header');
                if (!header) return;

                header.addEventListener('touchstart', (e) => window.startDrag(e, id), { passive: false });
                window.addEventListener('touchmove', (e) => handleMove(e), { passive: false });
                window.addEventListener('touchend', () => handleEnd());
            }

            // --- Resize Logic ---
            let resizeDir = null;
            let isResizing = false;
            let resizeWin = null;
            let startResizeRect = null;
            let startResizePos = null;

            function updateWindowCursor(e, win) {
                if (isResizing) return;
                const rect = win.getBoundingClientRect();
                const border = 10; // Detection area
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                let cursor = '';
                if (y < border && x < border) cursor = 'nw-resize';
                else if (y < border && x > rect.width - border) cursor = 'ne-resize';
                else if (y > rect.height - border && x < border) cursor = 'sw-resize';
                else if (y > rect.height - border && x > rect.width - border) cursor = 'se-resize';
                else if (y < border) cursor = 'n-resize';
                else if (y > rect.height - border) cursor = 's-resize';
                else if (x < border) cursor = 'w-resize';
                else if (x > rect.width - border) cursor = 'e-resize';

                win.style.cursor = cursor || 'default';
            }

            function getResizeDir(e, win) {
                const rect = win.getBoundingClientRect();
                const border = 10;
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                let dir = '';
                if (y < border) dir += 'n';
                if (y > rect.height - border) dir += 's';
                if (x < border) dir += 'w';
                if (x > rect.width - border) dir += 'e';
                return dir;
            }

            function handleResizeStart(e, win, id) {
                const dir = getResizeDir(e, win);
                if (!dir) return; // Not on edge

                if (activeWindows[id].maximized) return;

                e.preventDefault();
                isResizing = true;
                resizeWin = win;
                resizeDir = dir;
                win.classList.add('resizing');

                startResizeRect = {
                    left: win.offsetLeft,
                    top: win.offsetTop,
                    width: win.offsetWidth,
                    height: win.offsetHeight
                };
                startResizePos = { x: e.clientX, y: e.clientY };
            }

            window.addEventListener('mousemove', (e) => {
                if (!isResizing || !resizeWin) return;

                const dx = e.clientX - startResizePos.x;
                const dy = e.clientY - startResizePos.y;
                const rect = startResizeRect;

                const minW = 300;
                const minH = 200;

                if (resizeDir.includes('e')) {
                    resizeWin.style.width = `${Math.max(minW, rect.width + dx)}px`;
                }
                if (resizeDir.includes('s')) {
                    resizeWin.style.height = `${Math.max(minH, rect.height + dy)}px`;
                }
                if (resizeDir.includes('w')) {
                    const newW = Math.max(minW, rect.width - dx);
                    resizeWin.style.width = `${newW}px`;
                    resizeWin.style.left = `${rect.left + (rect.width - newW)}px`;
                }
                if (resizeDir.includes('n')) {
                    const newH = Math.max(minH, rect.height - dy);
                    resizeWin.style.height = `${newH}px`;
                    resizeWin.style.top = `${rect.top + (rect.height - newH)}px`;
                }
            });

            window.addEventListener('mouseup', () => {
                if (isResizing && resizeWin) {
                    resizeWin.classList.remove('resizing');
                }
                isResizing = false;
                resizeWin = null;
            });

            // --- Clock ---
            function updateClock() {
                const now = new Date();
                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                const day = days[now.getDay()];
                const time = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
                document.getElementById('clock').innerText = `${day} ${time}`;
            }
            setInterval(updateClock, 1000);
            updateClock();


            // --- Terminal Logic ---
            function resolvePath(path) {
                const parts = path.split('/').filter(p => p);
                let current = fileSystem['root'];

                for (let part of parts) {
                    if (part === 'root') continue;
                    if (current[part] && typeof current[part] === 'object') {
                        current = current[part];
                    } else {
                        return null;
                    }
                }
                return current;
            }

            window.handleTerminalCommand = function (e) {
                const inputEl = document.getElementById('cmd-input');
                const output = document.getElementById('term-output');

                // History Navigation
                if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (terminalHistory.length > 0 && terminalHistoryIndex < terminalHistory.length - 1) {
                        terminalHistoryIndex++;
                        inputEl.value = terminalHistory[terminalHistory.length - 1 - terminalHistoryIndex];
                    }
                    return;
                }
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (terminalHistoryIndex > -1) {
                        terminalHistoryIndex--;
                        inputEl.value = terminalHistoryIndex >= 0 ? terminalHistory[terminalHistory.length - 1 - terminalHistoryIndex] : '';
                    }
                    return;
                }

                if (e.key === 'Enter') {
                    const input = e.target.value.trim();
                    if (!input) return;

                    // Echo command
                    output.innerHTML += `<div><span class="text-white">${document.getElementById('term-prompt').innerText}</span> ${input}</div>`;

                    // Handle Guessing Game Input Interception
                    if (guessGame.active) {
                        const guess = parseInt(input);
                        if (isNaN(guess)) {
                            output.innerHTML += `<div class="text-her-red">Please enter a valid number.</div>`;
                        } else {
                            guessGame.attempts++;
                            if (guess === guessGame.target) {
                                output.innerHTML += `<div class="text-green-500 font-bold">ðŸŽ‰ Correct! You guessed ${guessGame.target} in ${guessGame.attempts} attempts.</div>`;
                                guessGame.active = false;
                            } else if (guess < guessGame.target) {
                                output.innerHTML += `<div class="text-blue-400">Too low! Try again.</div>`;
                            } else {
                                output.innerHTML += `<div class="text-blue-400">Too high! Try again.</div>`;
                            }
                        }
                        inputEl.value = '';
                        output.scrollTop = output.scrollHeight;
                        return;
                    }

                    // Save to history
                    terminalHistory.push(input);
                    terminalHistoryIndex = -1;

                    const args = input.split(' ');
                    const cmd = args[0].toLowerCase();
                    let dirObj = resolvePath(currentPath.substring(1)); // Remove leading /

                    switch (cmd) {
                        case 'help':
                            output.innerHTML += `
                            <div class="opacity-80 mt-1 mb-2">
                                <div class="font-bold text-her-red mb-1">Available Commands:</div>
                                <div class="pl-2">
                                    <div class="text-blue-400 font-bold text-xs uppercase mt-2">System</div>
                                    <div>help, about, clear, neofetch</div>
                                    
                                    <div class="text-blue-400 font-bold text-xs uppercase mt-2">File Operations</div>
                                    <div>ls [-a], cd, pwd, mkdir, touch, rmdir, cat</div>
                                    
                                    <div class="text-blue-400 font-bold text-xs uppercase mt-2">Applications</div>
                                    <div>open [app], about, projects, resume</div>
                                    
                                    <div class="text-blue-400 font-bold text-xs uppercase mt-2">Fun & Games</div>
                                    <div>ðŸ’¡ Try 'help-fun' for entertainment commands!</div>
                                </div>
                            </div>`;
                            break;
                        case 'help-fun':
                            output.innerHTML += `
                            <div class="opacity-80 mt-1 mb-2">
                                <div class="font-bold text-purple-400 mb-2">ðŸŽ® Fun Commands:</div>
                                <div class="pl-2 space-y-2">
                                    <div>
                                        <div class="text-pink-400 font-bold text-xs uppercase mb-1">ðŸ“ Text & Art</div>
                                        <div class="pl-2 space-y-0.5">
                                            <div><span class="text-blue-300">ascii [text]</span> - Generate ASCII art</div>
                                            <div><span class="text-blue-300">figlet [text]</span> - Big block ASCII text</div>
                                            <div><span class="text-blue-300">cowsay [text]</span> - Make a cow say something</div>
                                            <div><span class="text-blue-300">flip [text]</span> - ÉŸlá´‰d Ê‡ÇxÊ‡ ndsá´‰pÇ poÊu</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-green-400 font-bold text-xs uppercase mb-1">ðŸŽ² Games & Interactive</div>
                                        <div class="pl-2 space-y-0.5">
                                            <div><span class="text-blue-300">guess</span> - Number guessing game</div>
                                            <div><span class="text-blue-300">8ball [question]</span> - Tech decision oracle</div>
                                            <div><span class="text-blue-300">hack</span> - Hack this site!</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-cyan-400 font-bold text-xs uppercase mb-1">ðŸŽ¬ Animations</div>
                                        <div class="pl-2 space-y-0.5">
                                            <div><span class="text-blue-300">matrix</span> - Enter the Matrix</div>
                                            <div><span class="text-blue-300">sl</span> - ðŸš‚ Steam locomotive</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-yellow-400 font-bold text-xs uppercase mb-1">ðŸ¥š Easter Eggs</div>
                                        <div class="pl-2 space-y-0.5">
                                            <div><span class="text-blue-300">hlx</span> - Î» Classified project...</div>
                                            <div><span class="text-blue-300">fallout</span> - ðŸ‘...</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-orange-400 font-bold text-xs uppercase mb-1">ðŸ”§ Utilities</div>
                                        <div class="pl-2 space-y-0.5">
                                            <div><span class="text-blue-300">calc [expr]</span> - Simple calculator</div>
                                            <div><span class="text-blue-300">fortune</span> - Get your daily fortune</div>
                                        </div>
                                    </div>
                                </div>
                            </div>`;
                            break;
                        case 'clear':
                            output.innerHTML = '';
                            break;
                        case 'whoami':
                            output.innerHTML += `<div>guest</div>`;
                            break;
                        case 'pwd':
                            output.innerHTML += `<div>${currentPath}</div>`;
                            break;
                        case 'ls':
                            let showHidden = args.includes('-a');
                            let content = '';
                            if (dirObj) {
                                Object.keys(dirObj).forEach(k => {
                                    if (!showHidden && k.startsWith('.')) return;
                                    const isDir = typeof dirObj[k] === 'object';
                                    content += `<span class="${isDir ? 'text-blue-400 font-bold' : ''} mr-4">${k}${isDir ? '/' : ''}</span>`;
                                });
                            }
                            output.innerHTML += `<div>${content}</div>`;
                            break;
                        case 'cd':
                            const target = args[1];
                            if (!target) break;
                            if (target === '..') {
                                const parts = currentPath.split('/');
                                if (parts.length > 2) {
                                    parts.pop();
                                    currentPath = parts.join('/');
                                }
                            } else {
                                if (dirObj && dirObj[target] && typeof dirObj[target] === 'object') {
                                    currentPath = currentPath === '/' ? `/${target}` : `${currentPath}/${target}`;
                                } else {
                                    output.innerHTML += `<div class="text-red-400">cd: no such directory: ${target}</div>`;
                                }
                            }
                            document.getElementById('term-prompt').innerText = `guest@portfolio ${currentPath === '/home/guest' ? '~' : currentPath} $`;
                            break;
                        case 'mkdir':
                            if (args[1]) {
                                if (dirObj[args[1]]) output.innerHTML += `<div class="text-red-400">mkdir: cannot create directory '${args[1]}': File exists</div>`;
                                else dirObj[args[1]] = {};
                            }
                            break;
                        case 'touch':
                            if (args[1]) {
                                dirObj[args[1]] = 'FILE';
                            }
                            break;
                        case 'rmdir':
                            if (args[1]) {
                                if (dirObj[args[1]] && typeof dirObj[args[1]] === 'object') {
                                    if (Object.keys(dirObj[args[1]]).length === 0) delete dirObj[args[1]];
                                    else output.innerHTML += `<div class="text-red-400">rmdir: failed to remove '${args[1]}': Directory not empty</div>`;
                                } else {
                                    output.innerHTML += `<div class="text-red-400">rmdir: failed to remove '${args[1]}': No such file or directory</div>`;
                                }
                            }
                            break;
                        case 'cat':
                            if (args[1] === 'readme.md') {
                                output.innerHTML += `<div class="whitespace-pre-wrap opacity-80 my-2">Hi, I'm Pietro. This is my interactive portfolio.\nRun 'about' to see the graphical version.</div>`;
                            } else if (args[1] === '.secrets') {
                                output.innerHTML += `<div class="whitespace-pre-wrap my-2 text-purple-400">ðŸ”® You found a secret!\n\nHints:\n  - Try 'noclip' for R&D access\n  - 'hack' might do something fun\n  - 'matrix' is quite immersive\n  - 'guess' starts a mini-game\n\nThanks for exploring! ðŸš€</div>`;
                            } else if (dirObj && dirObj[args[1]] === 'FILE') {
                                output.innerHTML += `<div>(Empty file)</div>`;
                            } else {
                                output.innerHTML += `<div class="text-red-400">cat: ${args[1]}: No such file</div>`;
                            }
                            break;
                        case 'noclip':
                            openWindow('experiments');
                            output.innerHTML += `<div class="text-green-500 font-bold my-2">ACCESS GRANTED. WELCOME TO R&D.</div>`;
                            break;
                        case 'open':
                            const appName = args[1]?.toLowerCase();
                            if (windows[appName] || appName === 'terminal' || appName === 'vault') {
                                window.openWindow(appName === 'terminal' ? 'terminal' : appName);
                                output.innerHTML += `<div>Opening ${appName}...</div>`;
                            } else {
                                output.innerHTML += `<div class="text-red-400">App not found: ${appName}</div>`;
                            }
                            break;
                        case 'about': window.openWindow('about'); break;
                        case 'projects': window.openWindow('projects'); break;
                        case 'resume': window.openWindow('resume'); break;
                        case 'ascii':
                            const text = args.slice(1).join(' ').toUpperCase() || "HELLO";
                            let art = "";
                            for (let i = 0; i < 5; i++) {
                                let line = "";
                                for (let char of text) {
                                    if (asciiAlpha[char]) line += asciiAlpha[char][i] + "  ";
                                    else line += "     ";
                                }
                                art += line + "\n";
                            }
                            output.innerHTML += `<pre class="text-[10px] leading-3 text-green-400 my-2 overflow-x-auto">${art}</pre>`;
                            break;
                        case 'cowsay':
                            const msg = args.slice(1).join(' ') || "Moo!";
                            const cow = `
         \\   ^__^
          \\  (oo)\\_______
             (__)\\       )\\/\\
                 ||----w |
                 ||     ||`;
                            output.innerHTML += `<pre class="text-xs text-blue-300 my-2"> &lt; ${msg} &gt;${cow}</pre>`;
                            break;
                        case 'fortune':
                            const fortune = fortunes[Math.floor(Math.random() * fortunes.length)];
                            output.innerHTML += `<div class="text-purple-300 italic my-2">ðŸ”® ${fortune}</div>`;
                            break;
                        case 'calc':
                            try {
                                const expr = args.slice(1).join('');
                                // Safe-ish eval for portfolio demo
                                if (/^[0-9+\-*/().\s]+$/.test(expr)) {
                                    // eslint-disable-next-line no-new-func
                                    const result = new Function('return ' + expr)();
                                    output.innerHTML += `<div class="text-green-400 font-bold">= ${result}</div>`;
                                } else {
                                    output.innerHTML += `<div class="text-red-400">Invalid characters in expression.</div>`;
                                }
                            } catch (e) {
                                output.innerHTML += `<div class="text-red-400">Error: ${e.message}</div>`;
                            }
                            break;
                        case 'guess':
                            guessGame.active = true;
                            guessGame.target = Math.floor(Math.random() * 100) + 1;
                            guessGame.attempts = 0;
                            output.innerHTML += `<div class="text-green-400 font-bold my-2">ðŸŽ® Guess the Number Game Started!</div><div>I'm thinking of a number between 1 and 100.</div><div>Type your guess below:</div>`;
                            break;
                        case 'hack':
                            output.innerHTML += `<div class="text-green-500">Initiating brute force...</div>`;
                            let progress = 0;
                            const hackInterval = setInterval(() => {
                                progress += 10;
                                if (progress <= 100) {
                                    output.innerHTML += `<div>[${'#'.repeat(progress / 10)}${'.'.repeat(10 - progress / 10)}] ${progress}% - Bypassing Mainframe...</div>`;
                                    output.scrollTop = output.scrollHeight;
                                } else {
                                    clearInterval(hackInterval);
                                    output.innerHTML += `<div class="text-green-400 font-bold">ACCESS GRANTED. SYSTEM COMPROMISED.</div>`;
                                    output.scrollTop = output.scrollHeight;
                                }
                            }, 500);
                            break;
                        case 'neofetch':
                            const logo = `
        .--.
       |o_o |
       |:_/ |
      //   \\ \\
     (|     |)
    /'\\_   _/ \`\\
    \\___)=(___/
`;
                            const info = `
<span class="text-blue-400">guest@portfolio-os</span>
--------------------
<span class="text-her-red">OS</span>: OS93 Version 1.4 (Blue-Jonze)
<span class="text-her-red">Host</span>: Browser Virtual Machine
<span class="text-her-red">Kernel</span>: Linux micro-kernel 6.8.0-45
<span class="text-her-red">Uptime</span>: ${Math.floor(performance.now() / 60000)} mins
<span class="text-her-red">Shell</span>: posh 1.0.0
<span class="text-her-red">Resolution</span>: ${window.innerWidth}x${window.innerHeight}
<span class="text-her-red">Theme</span>: ${document.documentElement.classList.contains('dark') ? 'Dark' : 'Light'}
<span class="text-her-red">CPU</span>: Web Worker @ 2.4GHz
<span class="text-her-red">Memory</span>: 640KB / 1337MB
`;
                            output.innerHTML += `<div class="flex gap-4 my-2 font-mono text-xs">
    <pre class="text-blue-500 hidden sm:block">${logo}</pre>
    <pre>${info}</pre>
</div>`;
                            break;
                        case 'matrix':
                            // Find the terminal content container
                            const container = document.getElementById('term-container');
                            if (!container) break;

                            const canvas = document.createElement('canvas');
                            canvas.className = "absolute inset-0 z-50 cursor-pointer";
                            container.appendChild(canvas);

                            const ctx = canvas.getContext('2d');
                            canvas.width = container.clientWidth;
                            canvas.height = container.clientHeight;

                            const fontSize = 16;
                            const columns = Math.floor(canvas.width / fontSize);
                            const drops = new Array(columns).fill(1);
                            // Matrix characters: Japanese katakana + numbers + symbols
                            const chars = "ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒŽãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒžãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ²ãƒ³0123456789:ãƒ».\"=*+-<>Â¦|_";

                            let frameId;

                            function draw() {
                                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                                ctx.fillRect(0, 0, canvas.width, canvas.height);

                                ctx.font = fontSize + 'px monospace';

                                for (let i = 0; i < drops.length; i++) {
                                    const text = chars.charAt(Math.floor(Math.random() * chars.length));
                                    
                                    // Leading character is brighter (white/bright green)
                                    ctx.fillStyle = '#AFA';
                                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                                    
                                    // Trail characters are standard green
                                    ctx.fillStyle = '#0F0';

                                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                                        drops[i] = 0;
                                    }
                                    drops[i]++;
                                }
                                // Slower frame rate (~30fps) for cinematic Matrix feel
                                frameId = setTimeout(draw, 33);
                            }

                            draw();

                            function stopMatrix() {
                                clearTimeout(frameId);
                                if (canvas.parentNode) canvas.parentNode.removeChild(canvas);
                                document.removeEventListener('keydown', stopMatrix);
                                document.getElementById('cmd-input').focus();
                            }

                            setTimeout(() => {
                                document.addEventListener('keydown', stopMatrix);
                                canvas.addEventListener('click', stopMatrix);
                            }, 200);
                            break;
                        case 'sl':
                            // Steam Locomotive - Classic typo corrector!
                            const slContainer = document.getElementById('term-container');
                            if (!slContainer) break;

                            // Hide the input while train is running
                            inputEl.disabled = true;

                            // Create overlay for the animation
                            const slOverlay = document.createElement('div');
                            slOverlay.className = "absolute inset-0 z-50 bg-black overflow-hidden font-mono";
                            slOverlay.style.fontSize = '10px';
                            slOverlay.style.lineHeight = '1.2';
                            slContainer.appendChild(slOverlay);

                            // Steam Locomotive ASCII frames
                            const trainFrames = [
                                [
                                    "                         (@@) (  ) (@)  ( )  @@    ()    @     O     @     O      @",
                                    "                    (   )",
                                    "                (@@@@)",
                                    "             (    )",
                                    "",
                                    "           (@@@)",
                                    "        ====        ________                ___________",
                                    "    _D _|  |_______/        \\__I_I_____===__|_________|",
                                    "     |(_)---  |   H\\________/ |   |        =|___ ___|      _________________",
                                    "     /     |  |   H  |  |     |   |         ||_| |_||     _|                \\_____A",
                                    "    |      |  |   H  |__--------------------| [___] |   =|                        |",
                                    "    | ________|___H__/__|_____/[][]~\\_______|       |   -|                        |",
                                    "    |/ |   |-----------I_____I [][] []  D   |=======|____|________________________|_",
                                    "__/ =| o |=-~~\\  /~~\\  /~~\\  /~~\\ ____Y___________|__|__________________________|_",
                                    " |/-=|___|=    ||    ||    ||    |_____/~\\___/          |_D__D__D_|  |_D__D__D_|",
                                    "  \\_/      \\O=====O=====O=====O_/      \\_/               \\_/   \\_/    \\_/   \\_/"
                                ],
                                [
                                    "                         (  ) (@@) ( )  (@)  ()    @@    O     @     O     @      O",
                                    "                    (@@@)",
                                    "                (    )",
                                    "             (@@@@)",
                                    "",
                                    "           (   )",
                                    "        ====        ________                ___________",
                                    "    _D _|  |_______/        \\__I_I_____===__|_________|",
                                    "     |(_)---  |   H\\________/ |   |        =|___ ___|      _________________",
                                    "     /     |  |   H  |  |     |   |         ||_| |_||     _|                \\_____A",
                                    "    |      |  |   H  |__--------------------| [___] |   =|                        |",
                                    "    | ________|___H__/__|_____/[][]~\\_______|       |   -|                        |",
                                    "    |/ |   |-----------I_____I [][] []  D   |=======|____|________________________|_",
                                    "__/ =| o |=-~~\\  /~~\\  /~~\\  /~~\\ ____Y___________|__|__________________________|_",
                                    " |/-=|___|=O=====O=====O=====O   |_____/~\\___/          |_D__D__D_|  |_D__D__D_|",
                                    "  \\_/      \\_/   \\_/   \\_/   \\_/      \\_/               \\_/   \\_/    \\_/   \\_/"
                                ]
                            ];

                            const trainWidth = 90;
                            let slPosition = slOverlay.clientWidth;
                            let slFrame = 0;
                            let slAnimationId;

                            function renderTrain() {
                                const frame = trainFrames[slFrame % 2];
                                const padding = Math.max(0, Math.floor(slPosition));
                                
                                let trainHtml = '<pre class="text-green-400 whitespace-pre" style="position:absolute;left:' + padding + 'px;top:20px;">';
                                frame.forEach(line => {
                                    trainHtml += line + '\n';
                                });
                                trainHtml += '</pre>';
                                
                                slOverlay.innerHTML = trainHtml;
                                slPosition -= 8; // Speed
                                slFrame++;

                                if (slPosition > -trainWidth * 10) {
                                    slAnimationId = requestAnimationFrame(renderTrain);
                                } else {
                                    // Animation complete
                                    stopSl();
                                }
                            }

                            function stopSl() {
                                cancelAnimationFrame(slAnimationId);
                                if (slOverlay.parentNode) slOverlay.parentNode.removeChild(slOverlay);
                                inputEl.disabled = false;
                                inputEl.focus();
                                output.innerHTML += `<div class="text-yellow-400 mt-2">ðŸš‚ Did you mean <span class="text-blue-300 font-bold">ls</span>?</div>`;
                                output.scrollTop = output.scrollHeight;
                            }

                            renderTrain();
                            break;
                        case 'hlx':
                            // Half-Life 3 / HLX Easter Egg
                            inputEl.disabled = true;
                            
                            const hlxMessages = [
                                { text: '<span class="text-green-400">Connecting to Valve servers...</span>', delay: 0 },
                                { text: '<span class="text-green-400">Authenticating: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%</span>', delay: 800 },
                                { text: '<span class="text-yellow-400">Loading HLX assets: 1... 2... 2.5... 2.75... 2.9... 2.99... 2.999...</span>', delay: 1600 },
                                { text: '', delay: 2400 }, // Lambda will be inserted here
                                { text: '<span class="text-gray-400 italic">"The right man in the wrong place can make all the difference in the world..."</span>', delay: 4500 },
                                { text: '<span class="text-gray-500 text-xs">                                                              - G-Man</span>', delay: 5000 },
                                { text: '', delay: 5800 },
                                { text: '<span class="text-red-500 font-bold">ERROR: Unable to count to 3. This is a known Valve limitation.</span>', delay: 6300 }
                            ];

                            // Lambda ASCII art with glitch effect
                            const lambdaArt = `
<pre class="hlx-lambda text-orange-500 font-bold my-2" style="text-shadow: 0 0 10px rgba(255,165,0,0.5);">
â €â €â €â €â €â €â €â €â €â¢€â£€â£ â£¤â£¤â£´â£¦â£¤â£¤â£„â£€â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â¢€â£¤â£¾â£¿â£¿â£¿â£¿â ¿â ¿â ¿â ¿â£¿â£¿â£¿â£¿â£¶â£¤â¡€â €â €â €â €â €â €
â €â €â €â €â£ â£¾â£¿â£¿â¡¿â ›â ‰â €â €â €â €â €â €â €â €â ‰â ›â¢¿â£¿â£¿â£¶â¡€â €â €â €â €
â €â €â €â£´â£¿â£¿â Ÿâ â €â €â €â£¶â£¶â£¶â£¶â¡†â €â €â €â €â €â €â ˆâ »â£¿â£¿â£¦â €â €â €
â €â €â£¼â£¿â£¿â ‹â €â €â €â €â €â ›â ›â¢»â£¿â£¿â¡€â €â €â €â €â €â €â €â ™â£¿â£¿â£§â €â €
â €â¢¸â£¿â£¿â ƒâ €â €â €â €â €â €â €â €â¢€â£¿â£¿â£·â €â €â €â €â €â €â €â €â ¸â£¿â£¿â¡‡â €
â €â£¿â£¿â¡¿â €â €â €â €â €â €â €â €â¢€â£¾â£¿â£¿â£¿â£‡â €â €â €â €â €â €â €â €â£¿â£¿â£¿â €
â €â£¿â£¿â¡‡â €â €â €â €â €â €â €â¢ â£¿â£¿â¡Ÿâ¢¹â£¿â£¿â¡†â €â €â €â €â €â €â €â£¹â£¿â£¿â €
â €â£¿â£¿â£·â €â €â €â €â €â €â£°â£¿â£¿â â €â €â¢»â£¿â£¿â¡„â €â €â €â €â €â €â£¿â£¿â¡¿â €
â €â¢¸â£¿â£¿â¡†â €â €â €â €â£´â£¿â¡¿â ƒâ €â €â €â ˆâ¢¿â£¿â£·â£¤â£¤â¡†â €â €â£°â£¿â£¿â ‡â €
â €â €â¢»â£¿â£¿â£„â €â €â ¾â ¿â ¿â â €â €â €â €â €â ˜â£¿â£¿â¡¿â ¿â ›â €â£°â£¿â£¿â¡Ÿâ €â €
â €â €â €â »â£¿â£¿â£§â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â£¾â£¿â£¿â â €â €â €
â €â €â €â €â ˆâ »â£¿â£¿â£·â£¤â£„â¡€â €â €â €â €â €â €â¢€â£ â£´â£¾â£¿â£¿â Ÿâ â €â €â €â €
â €â €â €â €â €â €â ˆâ ›â ¿â£¿â£¿â£¿â£¿â£¿â£¶â£¶â£¿â£¿â£¿â£¿â£¿â ¿â ‹â â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â ‰â ‰â ›â ›â ›â ›â ›â ›â ‰â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
</pre>`;

                            let hlxIndex = 0;
                            
                            function showNextHlx() {
                                if (hlxIndex >= hlxMessages.length) {
                                    inputEl.disabled = false;
                                    inputEl.focus();
                                    // Start glitch effect on lambda
                                    const lambdaEl = output.querySelector('.hlx-lambda');
                                    if (lambdaEl) {
                                        let glitchCount = 0;
                                        const glitchInterval = setInterval(() => {
                                            if (glitchCount > 10) {
                                                clearInterval(glitchInterval);
                                                lambdaEl.style.transform = 'none';
                                                lambdaEl.style.opacity = '1';
                                                return;
                                            }
                                            const offsetX = (Math.random() - 0.5) * 4;
                                            const offsetY = (Math.random() - 0.5) * 2;
                                            const skew = (Math.random() - 0.5) * 3;
                                            lambdaEl.style.transform = `translate(${offsetX}px, ${offsetY}px) skewX(${skew}deg)`;
                                            lambdaEl.style.opacity = Math.random() > 0.3 ? '1' : '0.7';
                                            // Color glitch
                                            lambdaEl.style.color = Math.random() > 0.8 ? '#ff6b6b' : '#f97316';
                                            glitchCount++;
                                        }, 100);
                                    }
                                    return;
                                }
                                
                                const msg = hlxMessages[hlxIndex];
                                const nextDelay = hlxIndex < hlxMessages.length - 1 
                                    ? hlxMessages[hlxIndex + 1].delay - msg.delay 
                                    : 500;
                                
                                if (hlxIndex === 3) {
                                    // Insert lambda art
                                    output.innerHTML += lambdaArt;
                                } else if (msg.text) {
                                    output.innerHTML += `<div>${msg.text}</div>`;
                                }
                                
                                output.scrollTop = output.scrollHeight;
                                hlxIndex++;
                                setTimeout(showNextHlx, nextDelay);
                            }
                            
                            showNextHlx();
                            break;
                        case 'fallout':
                            // Fallout Vault Boy Easter Egg
                            const vaultBoyArt = `
<pre class="text-yellow-400 my-2" style="text-shadow: 0 0 5px rgba(250,204,21,0.3);">
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£¾â£¿â ¿â£·â£¦â£€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â¢€â£¤â£¶â£¤â£¤â£´â£¿â Ÿâ â €â ˆâ ›â ¿â£¿â£¿â£¶â£¶â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â¢€â£´â£¶â£‡â €â¢€â£´â£¿â Ÿâ ‰â ‰â ™â ›â â €â €â €â €â €â €â €â ˆâ ‰â »â£¿â£†â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â¢€â£¿â¡Ÿâ ™â¢¿â£¿â£¿â Ÿâ â €â €â €â €â €â €â €â£€â¡€â €â €â €â €â €â €â €â ˜â£¿â£·â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â ¸â£¿â¡‡â €â €â €â €â €â¢€â¡´â ¶â¢¦â£„â£€â£¤â ¾â ›â ›â£§â¡€â €â €â €â €â €â €â ˆâ ›â¢¿â£¿â£„â €â €â €â €â €â €â €â €â €â €â €â €â €
â¢ â£¿â£‡â €â €â €â €â£´â ‹â €â €â €â ˆâ ‰â â €â €â €â ˆâ »â£¦â£¤â¡¤â ¶â »â¢¿â£¦â €â €â¢»â£¿â£†â €â €â €â €â €â €â €â €â €â €â €â €
â¢¸â£¿â ‰â¢³â£¶â¢¶â¡¿â ‡â €â €â €â €â €â €â €â €â €â£€â¡€â €â €â €â €â €â €â €â£¿â â €â €â£¿â£¿â €â €â €â €â €â €â €â €â €â €â €â €
â ˜â£¿â£„â¡¾â â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ ™â „â €â €â €â €â¢ â¡¼â ‹â €â €â €â£¿â£¿â €â €â €â €â €â €â €â €â €â €â €â €
â €â¢¹â¡¿â â €â¢€â£¾â¡‡â €â €â €â €â €â €â €â €â£€â£€â¡€â €â €â €â €â €â  â£â¢¦â¡€â €â €â£¿â£¿â €â €â €â €â €â €â €â €â €â €â €â €
â¢€â£¿â ‡â €â €â ˜â£¿â ‡â €â €â¢€â Žâ €â €â €â ˜â ›â ›â ¿â †â €â €â €â €â  â£â¢§â¡³â¡„â£¸â£¿â¡Ÿâ €â €â €â €â €â €â €â €â €â €â €â €
â¢¸â£¿â €â €â €â €â €â €â¢ â¡¾â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â¢¢â£œâ¢·â£½â£·â£¿â£¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €
â¢¸â¡â €â €â €â €â €â €â¢¿â£‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ™â †â£¹â£¿â£¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €
â¢¸â£‡â €â €â €â €â €â €â ˆâ ›â ‚â €â €â €â €â¢ â£„â €â €â €â €â €â €â €â €â €â €â ˜â£¿â£·â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â¢¸â£¿â €â €â£¾â£¤â£€â£€â£€â¢€â£€â£€â£€â¡¤â ”â šâ¢¿â£·â €â €â €â €â €â €â €â €â €â¢€â£¿â£¿â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â£¿â£‡â €â »â ³â¢¤â£ˆâ£‰â ‰â ‰â €â£€â£€â£¤â –â ‹â Ÿâ €â €â €â €â €â €â¢€â£€â£ â£¾â£¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â ˜â£¿â£†â €â €â €â ˆâ ™â£›â£›â ›â ›â ‰â €â €â €â €â €â €â €â €â¢€â£´â£¿â ¿â ›â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â ˜â¢¿â£§â¡€â €â €â ˆâ ›â ›â ƒâ €â €â €â €â €â €â €â €â¢€â£´â£¿â¡¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â ˆâ »â£¿â£¦â£„â €â €â €â €â €â €â €â €â €â €â£€â£´â£¿â¡¿â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â ˆâ ™â ¿â£¿â£¶â£¦â£¤â£¤â£¤â£¤â£¶â£¶â£¿â ¿â ›â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â ˆâ ‰â ‰â ‰â ‰â ‰â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
</pre>`;
                            output.innerHTML += vaultBoyArt;
                            output.innerHTML += `<div class="text-yellow-500 italic mt-2">"War. War never changes."</div>`;
                            output.innerHTML += `<div class="text-gray-500 text-xs mt-1">S.P.E.C.I.A.L. Stats Loaded â€¢ Pip-Boy 3000 Mark IV</div>`;
                            output.scrollTop = output.scrollHeight;
                            break;
                        case '8ball':
                            // Magic 8-ball for tech decisions
                            const question = args.slice(1).join(' ');
                            const techResponses = [
                                // Positive
                                { text: "It is certain. Ship it!", color: "text-green-400" },
                                { text: "Yes, but write tests first.", color: "text-green-400" },
                                { text: "Reply hazy, try Stack Overflow.", color: "text-yellow-400" },
                                { text: "Without a doubt. LGTM!", color: "text-green-400" },
                                { text: "My sources say yes. Deploy to prod.", color: "text-green-400" },
                                { text: "Outlook good. Merge it.", color: "text-green-400" },
                                // Neutral
                                { text: "Ask again after coffee.", color: "text-yellow-400" },
                                { text: "Better not tell you now... check the logs.", color: "text-yellow-400" },
                                { text: "Cannot predict now. Have you tried turning it off and on?", color: "text-yellow-400" },
                                { text: "Concentrate and ask again. Or just read the docs.", color: "text-yellow-400" },
                                // Negative
                                { text: "Don't count on it. That's technical debt.", color: "text-red-400" },
                                { text: "My reply is no. Use spaces, not tabs.", color: "text-red-400" },
                                { text: "Outlook not so good. Sounds like a future bug.", color: "text-red-400" },
                                { text: "Very doubtful. Have you considered a rewrite?", color: "text-red-400" },
                                { text: "Signs point to... segfault.", color: "text-red-400" },
                                { text: "404: Answer not found.", color: "text-red-400" }
                            ];
                            const response = techResponses[Math.floor(Math.random() * techResponses.length)];
                            output.innerHTML += `<div class="my-2">
                                <div class="text-purple-400">ðŸŽ± You asked: "${question || 'nothing'}"</div>
                                <div class="${response.color} font-bold mt-1">âžœ ${response.text}</div>
                            </div>`;
                            output.scrollTop = output.scrollHeight;
                            break;
                        case 'flip':
                            // Flip text upside down
                            const flipMap = {
                                'a': 'É', 'b': 'q', 'c': 'É”', 'd': 'p', 'e': 'Ç', 'f': 'ÉŸ', 'g': 'Æƒ', 'h': 'É¥',
                                'i': 'á´‰', 'j': 'É¾', 'k': 'Êž', 'l': 'l', 'm': 'É¯', 'n': 'u', 'o': 'o', 'p': 'd',
                                'q': 'b', 'r': 'É¹', 's': 's', 't': 'Ê‡', 'u': 'n', 'v': 'ÊŒ', 'w': 'Ê', 'x': 'x',
                                'y': 'ÊŽ', 'z': 'z', 'A': 'âˆ€', 'B': 'q', 'C': 'Æ†', 'D': 'p', 'E': 'ÆŽ', 'F': 'â„²',
                                'G': 'â…', 'H': 'H', 'I': 'I', 'J': 'Å¿', 'K': 'Êž', 'L': 'Ë¥', 'M': 'W', 'N': 'N',
                                'O': 'O', 'P': 'Ô€', 'Q': 'Q', 'R': 'É¹', 'S': 'S', 'T': 'âŠ¥', 'U': 'âˆ©', 'V': 'Î›',
                                'W': 'M', 'X': 'X', 'Y': 'â…„', 'Z': 'Z', '1': 'Æ–', '2': 'á„…', '3': 'Æ', '4': 'ã„£',
                                '5': 'Ï›', '6': '9', '7': 'ã„¥', '8': '8', '9': '6', '0': '0', '.': 'Ë™', ',': "'",
                                "'": ',', '"': 'â€ž', '`': ',', '?': 'Â¿', '!': 'Â¡', '[': ']', ']': '[', '(': ')',
                                ')': '(', '{': '}', '}': '{', '<': '>', '>': '<', '_': 'â€¾', '^': 'v', '&': 'â…‹'
                            };
                            const flipText = args.slice(1).join(' ') || 'Hello World';
                            const flipped = flipText.split('').map(c => flipMap[c] || c).reverse().join('');
                            output.innerHTML += `<div class="text-cyan-400 my-2 font-bold">${flipped}</div>`;
                            output.scrollTop = output.scrollHeight;
                            break;
                        case 'figlet':
                            // Big ASCII art text
                            const figletText = (args.slice(1).join(' ') || 'HELLO').toUpperCase().slice(0, 10);
                            const figletFont = {
                                'A': ['  â–ˆâ–ˆ  ', ' â–ˆ  â–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ'],
                                'B': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                                'C': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ     ', 'â–ˆ     ', 'â–ˆ     ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                'D': ['â–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆ   â–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆ   â–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆ  '],
                                'E': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                                'F': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆ     ', 'â–ˆ     '],
                                'G': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ     ', 'â–ˆ  â–ˆâ–ˆâ–ˆ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                'H': ['â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ'],
                                'I': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                                'J': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆ ', '    â–ˆ ', 'â–ˆ   â–ˆ ', ' â–ˆâ–ˆâ–ˆ  '],
                                'K': ['â–ˆ   â–ˆ ', 'â–ˆ  â–ˆ  ', 'â–ˆâ–ˆâ–ˆ   ', 'â–ˆ  â–ˆ  ', 'â–ˆ   â–ˆ '],
                                'L': ['â–ˆ     ', 'â–ˆ     ', 'â–ˆ     ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                                'M': ['â–ˆ    â–ˆ', 'â–ˆâ–ˆ  â–ˆâ–ˆ', 'â–ˆ â–ˆâ–ˆ â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ'],
                                'N': ['â–ˆ    â–ˆ', 'â–ˆâ–ˆ   â–ˆ', 'â–ˆ â–ˆ  â–ˆ', 'â–ˆ  â–ˆ â–ˆ', 'â–ˆ   â–ˆâ–ˆ'],
                                'O': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                'P': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ     ', 'â–ˆ     '],
                                'Q': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆ  â–ˆ â–ˆ', 'â–ˆ   â–ˆ ', ' â–ˆâ–ˆ â–ˆ '],
                                'R': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ  â–ˆ  ', 'â–ˆ   â–ˆ '],
                                'S': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ     ', ' â–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                                'T': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  '],
                                'U': ['â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                'V': ['â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', ' â–ˆ  â–ˆ ', ' â–ˆ  â–ˆ ', '  â–ˆâ–ˆ  '],
                                'W': ['â–ˆ    â–ˆ', 'â–ˆ    â–ˆ', 'â–ˆ â–ˆâ–ˆ â–ˆ', 'â–ˆâ–ˆ  â–ˆâ–ˆ', 'â–ˆ    â–ˆ'],
                                'X': ['â–ˆ    â–ˆ', ' â–ˆ  â–ˆ ', '  â–ˆâ–ˆ  ', ' â–ˆ  â–ˆ ', 'â–ˆ    â–ˆ'],
                                'Y': ['â–ˆ    â–ˆ', ' â–ˆ  â–ˆ ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  '],
                                'Z': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆ ', '  â–ˆâ–ˆ  ', ' â–ˆ    ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                                ' ': ['      ', '      ', '      ', '      ', '      '],
                                '!': ['  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '      ', '  â–ˆâ–ˆ  '],
                                '?': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ ', '   â–ˆ  ', '      ', '  â–ˆ   '],
                                '0': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆâ–ˆ', 'â–ˆ  â–ˆ â–ˆ', 'â–ˆ â–ˆ  â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                '1': ['  â–ˆ   ', ' â–ˆâ–ˆ   ', '  â–ˆ   ', '  â–ˆ   ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                                '2': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', '   â–ˆâ–ˆ ', ' â–ˆâ–ˆ   ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                                '3': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '    â–ˆ ', ' â–ˆâ–ˆâ–ˆ  ', '    â–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                                '4': ['â–ˆ   â–ˆ ', 'â–ˆ   â–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆ ', '    â–ˆ '],
                                '5': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                                '6': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                '7': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆ ', '   â–ˆ  ', '  â–ˆ   ', '  â–ˆ   '],
                                '8': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                                '9': [' â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '     â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ ']
                            };
                            let figletOutput = '';
                            for (let row = 0; row < 5; row++) {
                                let line = '';
                                for (let char of figletText) {
                                    line += (figletFont[char] ? figletFont[char][row] : '      ') + ' ';
                                }
                                figletOutput += line + '\n';
                            }
                            output.innerHTML += `<pre class="text-green-400 text-xs my-2 overflow-x-auto">${figletOutput}</pre>`;
                            output.scrollTop = output.scrollHeight;
                            break;
                        default:
                            if (cmd) output.innerHTML += `<div class="text-red-400">Command not found: ${cmd}</div>`;
                    }

                    inputEl.value = '';
                    output.scrollTop = output.scrollHeight;
                }
            }

            window.renderVault = function (filter = '') {
                const grid = document.getElementById('vault-grid');
                if (!grid) return;
                grid.innerHTML = '';

                const term = filter.toLowerCase();
                const activeCategory = document.querySelector('.vault-tab.active')?.innerText.toUpperCase();

                vaultData.forEach(item => {
                    // Filter Logic
                    if (activeCategory && activeCategory !== 'ALL' && item.category.toUpperCase() !== activeCategory) return;
                    if (term && !item.title.toLowerCase().includes(term) && !item.desc.toLowerCase().includes(term)) return;

                    // Render Card
                    const card = document.createElement('div');
                    card.className = "p-4 border border-her-text/10 rounded-lg bg-white/60 dark:bg-white/5 hover:border-her-orange/50 transition-all cursor-pointer group";
                    if (item.action) card.setAttribute('onclick', item.action);

                    // Icon based on type - Custom Icons for variety
                    let icon = '';
                    switch (item.type) {
                        case 'doc':
                            icon = '<svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';
                            break;
                        case 'food':
                            icon = '<svg class="w-6 h-6 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-4.243 2.829a4.978 4.978 0 01-1.414-2.83m-1.414 5.658a9 9 0 01-2.167-9.238m7.824 2.167a1 1 0 111.414 1.414m-1.414-1.414L3 3m8.293 8.293l1.414 1.414"></path></svg>'; // Utensils/Abstract
                            break;
                        case 'music':
                            icon = '<svg class="w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg>';
                            break;
                        case 'book':
                            icon = '<svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>';
                            break;
                        case 'game':
                            icon = '<svg class="w-6 h-6 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg>';
                            break;
                        case 'app':
                            icon = '<svg class="w-6 h-6 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>';
                            break;
                        case 'video':
                            icon = '<svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                            break;
                        case 'link':
                            icon = '<svg class="w-6 h-6 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>';
                            break;
                        case 'location':
                            icon = '<svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>';
                            break;
                        default:
                            icon = '<svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>';
                    }

                    card.innerHTML = `
                    <div class="flex items-start justify-between mb-3">
                        ${icon}
                        ${item.status === 'soon' ? '<span class="px-2 py-0.5 text-[10px] font-bold bg-yellow-100 text-yellow-800 rounded">Soon</span>' : ''}
                    </div>
                    <div class="font-bold text-sm mb-1 group-hover:text-her-red transition-colors">${item.title}</div>
                    <div class="text-xs opacity-60 mb-3 line-clamp-2">${item.desc}</div>
                    <div class="flex items-center gap-2">
                        <span class="px-2 py-1 bg-black/5 dark:bg-white/10 rounded text-[10px] uppercase font-bold opacity-50">${item.category}</span>
                        ${item.status === 'ready' ? '<svg class="w-3 h-3 opacity-40" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>' : ''}
                    </div>
                `;
                    grid.appendChild(card);
                });
            }

            // --- Fake Monitor Logic ---
            window.switchMonitorTab = function (tab) {
                document.getElementById('mon-view-infra').style.display = 'none';
                document.getElementById('mon-view-cloudfront').style.display = 'none';
                document.getElementById('mon-view-billing').style.display = 'none';

                // Layout logic: Infra is default (block/space-y), Cloudfront block, Billing flex (center)
                if (tab === 'infra') document.getElementById('mon-view-infra').style.display = 'block';
                else if (tab === 'cf') document.getElementById('mon-view-cloudfront').style.display = 'block';
                else if (tab === 'bill') document.getElementById('mon-view-billing').style.display = 'flex';

                // Tab styling
                ['infra', 'cf', 'bill'].forEach(t => {
                    const el = document.getElementById(`tab-${t}`);
                    if (t === tab) {
                        el.classList.add('border-her-red', 'text-her-red', 'bg-white/50', 'dark:bg-black/20');
                        el.classList.remove('border-transparent', 'opacity-60');
                    } else {
                        el.classList.remove('border-her-red', 'text-her-red', 'bg-white/50', 'dark:bg-black/20');
                        el.classList.add('border-transparent', 'opacity-60');
                    }
                });
            }

            function startMonitor() {
                if (monitorInterval) clearInterval(monitorInterval);

                // Canvas Setup
                const canvas = document.getElementById('monitor-canvas');
                const ctx = canvas.getContext('2d');
                let dataPoints = new Array(50).fill(20);
                let errorPoints = new Array(50).fill(5); // Error rate series

                // KPI Simulation
                const kpiReq = document.getElementById('kpi-req');
                const kpiData = document.getElementById('kpi-data');
                const logContainer = document.getElementById('sys-log');

                const logs = [
                    "[INFO] Auto-scaling group: +1 instance",
                    "[INFO] Route53 health check: Healthy",
                    "[WARN] High latency detected in ap-south-1",
                    "[INFO] S3 Lifecycle rule executed",
                    "[INFO] CloudFront cache refresh"
                ];

                monitorInterval = setInterval(() => {
                    // Update Graph Data
                    dataPoints.shift();
                    errorPoints.shift();
                    const base = 40 + Math.random() * 30;
                    dataPoints.push(base);
                    errorPoints.push(Math.max(0, 5 + (Math.random() * 10 - 5))); // Sim error

                    // Render Graph
                    // Check visibility to save resources
                    if (canvas && canvas.offsetParent !== null) {
                        // Resize if needed
                        if (canvas.width !== canvas.clientWidth) {
                            canvas.width = canvas.clientWidth;
                            canvas.height = canvas.clientHeight;
                        }
                        const w = canvas.width;
                        const h = canvas.height;

                        ctx.clearRect(0, 0, w, h);

                        // Draw Main Traffic
                        ctx.beginPath();
                        ctx.moveTo(0, h);
                        dataPoints.forEach((p, i) => {
                            const x = (i / (dataPoints.length - 1)) * w;
                            const y = h - (p / 100) * h;
                            ctx.lineTo(x, y);
                        });
                        ctx.lineTo(w, h);
                        ctx.fillStyle = 'rgba(74, 124, 157, 0.2)'; // Blue tint #4A7C9D
                        ctx.fill();

                        // Stroke Main
                        ctx.beginPath();
                        dataPoints.forEach((p, i) => {
                            const x = (i / (dataPoints.length - 1)) * w;
                            const y = h - (p / 100) * h;
                            if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                        });
                        ctx.strokeStyle = '#4A7C9D'; // Blue
                        ctx.lineWidth = 2;
                        ctx.stroke();

                        // Draw Error Rate (Dashed)
                        ctx.beginPath();
                        ctx.setLineDash([5, 5]);
                        errorPoints.forEach((p, i) => {
                            const x = (i / (errorPoints.length - 1)) * w;
                            const y = h - (p / 100) * h; // Scale differently realistically, but for viz ok
                            if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                        });
                        ctx.strokeStyle = '#4A7C9D';
                        ctx.lineWidth = 1;
                        ctx.stroke();
                        ctx.setLineDash([]);
                    }

                    // Update KPIs
                    if (kpiReq && Math.random() > 0.7) kpiReq.innerText = (2.4 + Math.random() * 0.2).toFixed(1) + 'k';
                    if (logContainer && Math.random() > 0.9) {
                        const log = logs[Math.floor(Math.random() * logs.length)];
                        const div = document.createElement('div');
                        div.innerText = log;
                        logContainer.prepend(div);
                        if (logContainer.children.length > 5) logContainer.lastChild.remove();
                    }

                }, 1000);
            }

            // Initial site Launch
            setTimeout(() => {
                window.openWindow('about');
            }, 100);

        });
    </script>
</body>

</html>